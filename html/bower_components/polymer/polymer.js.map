{"version":3,"file":"polymer.js","sources":["../../polymer-gestures/src/scope.js","../../polymer-gestures/src/targetfind.js","../../polymer-gestures/src/touch-action.js","../../polymer-gestures/src/eventFactory.js","../../polymer-gestures/src/pointermap.js","../../polymer-gestures/src/dispatcher.js","../../polymer-gestures/src/installer.js","../../polymer-gestures/src/mouse.js","../../polymer-gestures/src/touch.js","../../polymer-gestures/src/ms.js","../../polymer-gestures/src/pointer.js","../../polymer-gestures/src/platform-events.js","../../polymer-gestures/src/track.js","../../polymer-gestures/src/hold.js","../../polymer-gestures/src/tap.js","../../polymer-expressions/third_party/esprima/esprima.js","../../polymer-expressions/src/polymer-expressions.js","../src/polymer.js","../src/boot.js","../src/lib/lang.js","../src/lib/job.js","../src/lib/dom.js","../src/lib/super.js","../src/lib/deserialize.js","../src/api.js","../src/instance/utils.js","../src/instance/events.js","../src/instance/attributes.js","../src/instance/properties.js","../src/instance/mdv.js","../src/instance/base.js","../src/instance/styles.js","../src/declaration/polymer.js","../src/declaration/path.js","../src/declaration/styles.js","../src/declaration/events.js","../src/declaration/properties.js","../src/declaration/attributes.js","../src/declaration/mdv.js","../src/declaration/prototype.js","../src/declaration/queue.js","../src/declaration/import.js","../src/declaration/polymer-element.js"],"names":["window","PolymerGestures","scope","target","shadow","inEl","shadowRoot","webkitShadowRoot","canTarget","Boolean","elementFromPoint","targetingShadow","s","this","olderShadow","os","olderShadowRoot","se","querySelector","allShadows","element","shadows","push","searchRoot","inRoot","x","y","st","sr","t","ssr","owner","document","parentNode","nodeType","Node","DOCUMENT_NODE","DOCUMENT_FRAGMENT_NODE","findTarget","inEvent","clientX","clientY","LCA","a","b","contains","adepth","depth","bdepth","d","walk","n","u","i","host","deepContains","common","insideNode","node","rect","getBoundingClientRect","left","right","top","bottom","targetFinding","bind","shadowSelector","v","selector","rule","attrib2css","selectors","styles","hasTouchAction","head","style","touchAction","hasShadowRoot","ShadowDOMPolyfill","createShadowRoot","forEach","r","String","map","el","createElement","textContent","appendChild","MOUSE_PROPS","MOUSE_DEFAULTS","NOP_FACTORY","eventFactory","preventTap","makeBaseEvent","inType","inDict","e","createEvent","initEvent","bubbles","cancelable","makeGestureEvent","Object","create","k","keys","length","makePointerEvent","p","buttons","pressure","pointerId","width","height","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","PointerMap","USE_MAP","m","Map","pointers","POINTERS_FN","values","prototype","size","set","inId","indexOf","has","delete","splice","get","clear","callback","thisArg","call","CLONE_PROPS","CLONE_DEFAULTS","HAS_SVG_INSTANCE","SVGElementInstance","dispatcher","pointermap","eventMap","eventSources","eventSourceList","gestures","gestureQueue","registerSource","name","source","newEvents","events","registerGesture","register","es","l","unregister","down","fireEvent","move","type","fillGestureQueue","up","cancel","tapPrevented","eventHandler","_handledByPG","fn","listen","addEvent","unlisten","removeEvent","eventName","addEventListener","boundHandler","removeEventListener","makeEvent","preventDefault","_target","dispatchEvent","cloneEvent","eventCopy","correspondingUseElement","clone","gestureTrigger","g","j","ev","requestAnimationFrame","boundGestureTrigger","Installer","add","remove","changed","binder","addCallback","removeCallback","changedCallback","MO","observer","mutationWatcher","Array","toArray","slice","filter","MutationObserver","WebKitMutationObserver","SELECTOR","OBSERVER_INIT","subtree","childList","attributes","attributeOldValue","attributeFilter","watchSubtree","observe","enableOnSubtree","readyState","installOnLoad","installNewSubtree","findElements","addElement","querySelectorAll","removeElement","elementChanged","oldValue","concatLists","accum","list","concat","isElement","ELEMENT_NODE","flattenMutationTree","inNodes","tree","reduce","mutations","mutationHandler","added","addedNodes","removed","removedNodes","console","warn","DEDUP_DIST","WHICH_TO_BUTTONS","HAS_BUTTONS","MouseEvent","mouseEvents","POINTER_ID","POINTER_TYPE","lastTouches","isEventSimulatedFromTouch","lts","dx","Math","abs","dy","prepareEvent","which","mousedown","mouseup","mousemove","relatedTarget","cleanupMouse","INSTALLER","DEDUP_TIMEOUT","CLICK_COUNT_TIMEOUT","ATTRIB","HAS_TOUCH_ACTION","touchEvents","elementAdded","getAttribute","touchActionToScrollType","_scrollType","elementRemoved","undefined","oldSt","scrollTypes","EMITTER","XSCROLLER","YSCROLLER","SCROLLER","exec","firstTouch","isPrimaryTouch","inTouch","identifier","setPrimaryTouch","firstXY","X","Y","scrolling","cancelResetClickCount","removePrimaryPointer","inPointer","resetClickCount","clickCount","resetId","setTimeout","clearTimeout","typeToButtons","ret","touch","id","currentTouchEvent","touchToPointer","cte","detail","webkitRadiusX","radiusX","webkitRadiusY","radiusY","webkitForce","force","self","processTouches","inFunction","tl","changedTouches","shouldScroll","scrollAxis","currentTarget","oa","da","doa","findTouch","inTL","vacuumTouches","touches","value","key","out","cancelOut","touchstart","dedupSynthMouse","touchmove","touchcancel","pointer","touchend","cleanUpPointer","lt","HAS_BITMAP_TYPE","MSPointerEvent","MSPOINTER_TYPE_MOUSE","msEvents","POINTER_TYPES","cleanup","MSPointerDown","MSPointerMove","MSPointerUp","MSPointerCancel","pointerEvents","pointerdown","pointermove","pointerup","pointercancel","PointerEvent","navigator","msPointerEnabled","ontouchstart","track","WIGGLE_THRESHOLD","clampDir","inDelta","calcPositionDelta","inA","inB","pageX","pageY","fireTrack","inTrackingData","downEvent","dd","lastMoveEvent","xDirection","yDirection","ddx","ddy","screenX","screenY","trackInfo","downTarget","tracking","hold","HOLD_DELAY","heldPointer","holdJob","pulse","Date","now","timeStamp","held","fireHold","clearInterval","setInterval","inHoldTime","holdTime","tap","shouldTap","downState","start","altKey","ctrlKey","metaKey","shiftKey","global","assert","condition","message","Error","isDecimalDigit","ch","isWhiteSpace","fromCharCode","isLineTerminator","isIdentifierStart","isIdentifierPart","isKeyword","skipWhitespace","index","charCodeAt","getIdentifier","scanIdentifier","Token","Identifier","Keyword","NullLiteral","BooleanLiteral","range","scanPunctuator","code2","ch2","code","ch1","Punctuator","throwError","Messages","UnexpectedToken","scanNumericLiteral","number","NumericLiteral","parseFloat","scanStringLiteral","quote","str","octal","StringLiteral","isIdentifierName","token","advance","EOF","lex","lookahead","peek","pos","messageFormat","error","args","arguments","msg","replace","whole","description","throwUnexpected","expect","match","matchKeyword","keyword","parseArrayInitialiser","elements","parseExpression","delegate","createArrayExpression","parseObjectPropertyKey","createLiteral","createIdentifier","parseObjectProperty","createProperty","parseObjectInitialiser","properties","createObjectExpression","parseGroupExpression","expr","parsePrimaryExpression","createThisExpression","parseArguments","parseNonComputedProperty","parseNonComputedMember","parseComputedMember","parseLeftHandSideExpression","property","createMemberExpression","parseUnaryExpression","parsePostfixExpression","createUnaryExpression","binaryPrecedence","prec","parseBinaryExpression","stack","operator","pop","createBinaryExpression","parseConditionalExpression","consequent","alternate","createConditionalExpression","parseFilter","createFilter","parseFilters","parseTopLevel","Syntax","parseInExpression","parseAsExpression","createTopLevel","createAsExpression","indexName","createInExpression","parse","inDelegate","state","labelSet","TokenName","ArrayExpression","BinaryExpression","CallExpression","ConditionalExpression","EmptyStatement","ExpressionStatement","Literal","LabeledStatement","LogicalExpression","MemberExpression","ObjectExpression","Program","Property","ThisExpression","UnaryExpression","UnknownLabel","Redeclaration","esprima","prepareBinding","expressionText","filterRegistry","expression","getExpression","scopeIdent","tagName","ex","model","oneTime","binding","getBinding","polymerExpressionScopeIdent_","indexIdent","polymerExpressionIndexIdent_","expressionParseCache","ASTDelegate","Expression","valueFn_","IdentPath","path","Path","object","accessor","valid","dynamicDeps","dynamic","simplePath","getFn","Filter","notImplemented","arg","valueFn","filters","deps","currentPath","ConstantObservable","value_","convertStylePropertyName","c","toLowerCase","findScope","prop","parentScopeName","hasOwnProperty","isLiteralExpression","pathString","isNaN","Number","PolymerExpressions","addPath","getValueFrom","setValue","newValue","setValueFrom",{"end":{"file":"../../polymer-expressions/src/polymer-expressions.js","comments_before":[],"nlb":false,"endpos":4597,"pos":4589,"col":8,"line":145,"value":"fullPath","type":"name"},"start":{"file":"../../polymer-expressions/src/polymer-expressions.js","comments_before":[],"nlb":false,"endpos":4597,"pos":4589,"col":8,"line":145,"value":"fullPath","type":"name"},"name":"fullPath"},"fullPath","fullPath_","last","context","propName","transform","toModelDirection","toModel","toDOM","apply","unaryOperators","+","-","!","binaryOperators","*","/","%","<",">","<=",">=","==","!=","===","!==","&&","||","op","argument","test","ident","arr","kind","obj","open","discardChanges","deliver","close","firstTime","firstValue","startReset","getValue","finishReset","setValueFn","CompoundObserver","ObserverTransform","count","random","toString","styleObject","parts","join","tokenList","tokens","prepareInstancePositionChanged","template","templateInstance","PathObserver","prepareInstanceModel","scopeName","parentScope","exposeGetExpression","getExpression_","Polymer","extend","api","getOwnPropertyNames","pd","getOwnPropertyDescriptor","defineProperty","nom","job","wait","stop","Job","go","inContext","boundComplete","complete","h","handle","cancelAnimationFrame","registry","HTMLElement","tag","getPrototypeForTag","getPrototypeOf","originalStopPropagation","Event","stopPropagation","cancelBubble","$super","arrayOfArgs","caller","_super","nameInThis","memoizeSuper","__proto__","n$","method","proto","nextSuper","super","deserializeValue","currentValue","inferredType","typeHandlers","string","date","boolean","parseInt","JSON","function","declaration","instance","publish","apis","utils","async","timeout","Platform","flush","cancelAsync","fire","onNode","event","CustomEvent","asyncFire","classFollows","anew","old","className","classList","nop","nob","asyncMethod","log","logFlags","EVENT_PREFIX","addHostListeners","eventDelegates","localName","methodName","getEventHandler","dispatchMethod","group","groupEnd","copyInstanceAttributes","a$","_instanceAttributes","hasAttribute","setAttribute","takeAttributes","_publishLC","attributeToProperty","propertyForAttribute","search","bindPattern","stringValue","serializeValue","reflectPropertyToAttribute","serializedValue","removeAttribute","bindProperties","inProperty","observable","LOG_BIND_PROPS","path_","inPath","Observer","bindToInstance","resolveBindingValue","createPropertyObserver","_observeNames","o","_propertyObserver","registerObservers","observeArrayValue","openPropertyObserver","notifyPropertyChanges","newValues","oldValues","paths","called","invokeMethod","propertyChanged_","reflect","callbackName","isArray","closeNamedObserver","ArrayObserver","registerNamedObserver","bindProperty","observers","_observers","closeObservers","closeObserverArray","observerArray","o$","_namedObservers","closeNamedObservers","mdv","instanceTemplate","syntax","bindingDelegate","dom","createInstance","bindings_","enableBindingsReflection","_recordBinding","mixinSuper","bindFinished","makeElementReady","asyncUnbindAll","_unbound","unbind","_unbindAllJob","unbindAll","cancelUnbindAll","mustachePattern","isBase","PolymerBase","base","created","ready","createdCallback","prepareElement","ownerDocument","isStagingDocument","_elementPrepared","shadowRoots","_readied","parseDeclarations","attachedCallback","attached","enteredView","hasBeenAttached","domReady","detachedCallback","preventDispose","detached","leftView","enteredViewCallback","leftViewCallback","enteredDocumentCallback","leftDocumentCallback","parseDeclaration","elementElement","fetchTemplate","root","shadowFromTemplate","shadowRootReady","lightFromTemplate","refNode","lightDomController","insertBefore","marshalNodeReferences","$","attributeChangedCallback","attributeChanged","onMutation","listener","disconnect","constructor","Base","shimCssText","cssText","is","ShadowCSS","makeScopeSelector","STYLE_SCOPE_ATTRIBUTE","STYLE_CONTROLLER_SCOPE","installControllerStyles","findStyleScope","scopeHasNamedStyle","cssTextForScope","installScopeCssText","installScopeStyle","cssTextToScopeStyle","applyStyleToScope","_scopeStyles","script","_currentScript","getRegisteredPrototype","registerPrototype","notifyPrototype","waitingForPrototype","client","waitPrototype","registerWhenReady","prototypesByName","declarations","deliverDeclarations","resolveElementPaths","urlResolver","resolveDom","addResolvePathApi","assetPath","URL","baseURI","resolvePath","urlPath","href","importRuleForSheet","sheet","baseUrl","createStyleElement","attr","firstElementChild","s$","nextElementSibling","cssTextFromSheet","__resource","matchesSelector","inSelector","matches","STYLE_SELECTOR","STYLE_LOADABLE_MATCH","SHEET_SELECTOR","STYLE_GLOBAL_SCOPE","SCOPE_ATTR","loadStyles","content","templateContent","convertSheetsToStyles","findLoadableStyles","templateUrl","styleResolver","copySheetAttributes","replaceChild","link","loadables","installSheets","cacheSheets","cacheStyles","installLocalSheets","installGlobalStyles","sheets","findNodes","removeChild","firstChild","matcher","nodes","array","templateNodes","styleForScope","scopeDescriptor","webkitMatchesSelector","mozMatchesSelector","mixedCaseEventTypes","parseHostEvents","delegates","addAttributeDelegates","hasEventPrefix","removeEventPrefix","trim","prefixLength","findController","controller","prepareEventBinding","eventType","bindingValue","handler","inferObservers","explodeObservers","exploded","ni","names","split","optimizePropertyMaps","_publishNames","publishProperties","requireProperties","lowerCaseMap","propertyDescriptors","propertyDescriptor","reflects","reflectHintForDescriptor","valueForDescriptor","createPropertyAccessors","createBindablePrototypeAccessor","ATTRIBUTES_ATTRIBUTE","ATTRIBUTES_REGEX","inheritAttributesObjects","inheritObject","publishAttributes","accumulateInstanceAttributes","clonable","isInstanceAttribute","blackList","extends","noscript","assetpath","cache-csstext","installBindingDelegate","ensurePrototypeTraversal","ancestor","extendeeName","buildPrototype","publishConstructor","extension","generateBasePrototype","desugarBeforeChaining","chainPrototypes","desugarAfterChaining","inheritMetaData","chained","chainObject","extendee","shimStyling","registerCallback","symbol","ctor","extnds","findBasePrototype","ensureBaseApi","memoizedBases","extended","mixinMethod","info","typeExtension","findTypeExtension","registerElement","inherited","queueForElement","mainQueue","importQueue","nextQueued","whenPolymerReady","queue","waitToReady","CustomElements","HTMLImports","whenImportsReady","addReadyCallback","check","__check","__go","useNative","readied","shift","nextElement","canReady","isEmpty","upgradeDocumentTree","readyCallbacks","importElements","elementOrFragment","importUrls","urls","url","frag","createDocumentFragment","rel","import","isRegistered","isCustomTag","init","loadResources","registered","waitingForQueue","waitingForResources","_register","handleNoScript","_needsResources","body"],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n */\nwindow.PolymerGestures = {};\n","/*\n * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n */\n\n(function(scope) {\n  var target = {\n    shadow: function(inEl) {\n      if (inEl) {\n        return inEl.shadowRoot || inEl.webkitShadowRoot;\n      }\n    },\n    canTarget: function(shadow) {\n      return shadow && Boolean(shadow.elementFromPoint);\n    },\n    targetingShadow: function(inEl) {\n      var s = this.shadow(inEl);\n      if (this.canTarget(s)) {\n        return s;\n      }\n    },\n    olderShadow: function(shadow) {\n      var os = shadow.olderShadowRoot;\n      if (!os) {\n        var se = shadow.querySelector('shadow');\n        if (se) {\n          os = se.olderShadowRoot;\n        }\n      }\n      return os;\n    },\n    allShadows: function(element) {\n      var shadows = [], s = this.shadow(element);\n      while(s) {\n        shadows.push(s);\n        s = this.olderShadow(s);\n      }\n      return shadows;\n    },\n    searchRoot: function(inRoot, x, y) {\n      if (inRoot) {\n        var t = inRoot.elementFromPoint(x, y);\n        var st, sr, os;\n        // is element a shadow host?\n        sr = this.targetingShadow(t);\n        while (sr) {\n          // find the the element inside the shadow root\n          st = sr.elementFromPoint(x, y);\n          if (!st) {\n            // check for older shadows\n            sr = this.olderShadow(sr);\n          } else {\n            // shadowed element may contain a shadow root\n            var ssr = this.targetingShadow(st);\n            return this.searchRoot(ssr, x, y) || st;\n          }\n        }\n        // light dom element is the target\n        return t;\n      }\n    },\n    owner: function(element) {\n      if (!element) {\n        return document;\n      }\n      var s = element;\n      // walk up until you hit the shadow root or document\n      while (s.parentNode) {\n        s = s.parentNode;\n      }\n      // the owner element is expected to be a Document or ShadowRoot\n      if (s.nodeType != Node.DOCUMENT_NODE && s.nodeType != Node.DOCUMENT_FRAGMENT_NODE) {\n        s = document;\n      }\n      return s;\n    },\n    findTarget: function(inEvent) {\n      var x = inEvent.clientX, y = inEvent.clientY;\n      // if the listener is in the shadow root, it is much faster to start there\n      var s = this.owner(inEvent.target);\n      // if x, y is not in this root, fall back to document search\n      if (!s.elementFromPoint(x, y)) {\n        s = document;\n      }\n      return this.searchRoot(s, x, y);\n    },\n    LCA: function(a, b) {\n      if (a === b) {\n        return a;\n      }\n      if (a && !b) {\n        return a;\n      }\n      if (b && !a) {\n        return b;\n      }\n      if (!b && !a) {\n        return document;\n      }\n      // fast case, a is a direct descendant of b or vice versa\n      if (a.contains) {\n        if (a.contains(b)) {\n          return a;\n        }\n        if (b.contains(a)) {\n          return b;\n        }\n      }\n      var adepth = this.depth(a);\n      var bdepth = this.depth(b);\n      var d = adepth - bdepth;\n      if (d > 0) {\n        a = this.walk(a, d);\n      } else {\n        b = this.walk(b, -d);\n      }\n      while(a && b && a !== b) {\n        a = this.walk(a, 1);\n        b = this.walk(b, 1);\n      }\n      return a;\n    },\n    walk: function(n, u) {\n      for (var i = 0; n && (i < u); i++) {\n        n = n.parentNode || n.host;\n      }\n      return n;\n    },\n    depth: function(n) {\n      var d = 0;\n      while(n) {\n        d++;\n        n = n.parentNode || n.host;\n      }\n      return d;\n    },\n    deepContains: function(a, b) {\n      var common = this.LCA(a, b);\n      // if a is the common ancestor, it must \"deeply\" contain b\n      return common === a;\n    },\n    insideNode: function(node, x, y) {\n      var rect = node.getBoundingClientRect();\n      return (rect.left <= x) && (x <= rect.right) && (rect.top <= y) && (y <= rect.bottom);\n    }\n  };\n  scope.targetFinding = target;\n  /**\n   * Given an event, finds the \"deepest\" node that could have been the original target before ShadowDOM retargetting\n   *\n   * @param {Event} Event An event object with clientX and clientY properties\n   * @return {Element} The probable event origninator\n   */\n  scope.findTarget = target.findTarget.bind(target);\n  /**\n   * Determines if the \"container\" node deeply contains the \"containee\" node, including situations where the \"containee\" is contained by one or more ShadowDOM\n   * roots.\n   *\n   * @param {Node} container\n   * @param {Node} containee\n   * @return {Boolean}\n   */\n  scope.deepContains = target.deepContains.bind(target);\n\n  /**\n   * Determines if the x/y position is inside the given node.\n   *\n   * Example:\n   *\n   *     function upHandler(event) {\n   *       var innode = PolymerGestures.insideNode(event.target, event.clientX, event.clientY);\n   *       if (innode) {\n   *         // wait for tap?\n   *       } else {\n   *         // tap will never happen\n   *       }\n   *     }\n   *\n   * @param {Node} node\n   * @param {Number} x Screen X position\n   * @param {Number} y screen Y position\n   * @return {Boolean}\n   */\n  scope.insideNode = target.insideNode;\n\n})(window.PolymerGestures);\n","/*\n *\n * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n */\n\n(function() {\n  function shadowSelector(v) {\n    return 'body /deep/ ' + selector(v);\n  }\n  function selector(v) {\n    return '[touch-action=\"' + v + '\"]';\n  }\n  function rule(v) {\n    return '{ -ms-touch-action: ' + v + '; touch-action: ' + v + ';}';\n  }\n  var attrib2css = [\n    'none',\n    'auto',\n    'pan-x',\n    'pan-y',\n    {\n      rule: 'pan-x pan-y',\n      selectors: [\n        'pan-x pan-y',\n        'pan-y pan-x'\n      ]\n    }\n  ];\n  var styles = '';\n  // only install stylesheet if the browser has touch action support\n  var head = document.head;\n  var hasTouchAction = typeof document.head.style.touchAction === 'string';\n  // only add shadow selectors if shadowdom is supported\n  var hasShadowRoot = !window.ShadowDOMPolyfill && document.head.createShadowRoot;\n\n  if (hasTouchAction) {\n    attrib2css.forEach(function(r) {\n      if (String(r) === r) {\n        styles += selector(r) + rule(r) + '\\n';\n        if (hasShadowRoot) {\n          styles += shadowSelector(r) + rule(r) + '\\n';\n        }\n      } else {\n        styles += r.selectors.map(selector) + rule(r.rule) + '\\n';\n        if (hasShadowRoot) {\n          styles += r.selectors.map(shadowSelector) + rule(r.rule) + '\\n';\n        }\n      }\n    });\n\n    var el = document.createElement('style');\n    el.textContent = styles;\n    document.head.appendChild(el);\n  }\n})();\n","/*\n * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * This is the constructor for new PointerEvents.\n *\n * New Pointer Events must be given a type, and an optional dictionary of\n * initialization properties.\n *\n * Due to certain platform requirements, events returned from the constructor\n * identify as MouseEvents.\n *\n * @constructor\n * @param {String} inType The type of the event to create.\n * @param {Object} [inDict] An optional dictionary of initial event properties.\n * @return {Event} A new PointerEvent of type `inType` and initialized with properties from `inDict`.\n */\n(function(scope) {\n\n  var MOUSE_PROPS = [\n    'bubbles',\n    'cancelable',\n    'view',\n    'detail',\n    'screenX',\n    'screenY',\n    'clientX',\n    'clientY',\n    'ctrlKey',\n    'altKey',\n    'shiftKey',\n    'metaKey',\n    'button',\n    'relatedTarget',\n    'pageX',\n    'pageY'\n  ];\n\n  var MOUSE_DEFAULTS = [\n    false,\n    false,\n    null,\n    null,\n    0,\n    0,\n    0,\n    0,\n    false,\n    false,\n    false,\n    false,\n    0,\n    null,\n    0,\n    0\n  ];\n\n  var NOP_FACTORY = function(){ return function(){}; };\n\n  var eventFactory = {\n    // TODO(dfreedm): this is overridden by tap recognizer, needs review\n    preventTap: NOP_FACTORY,\n    makeBaseEvent: function(inType, inDict) {\n      var e = document.createEvent('Event');\n      e.initEvent(inType, inDict.bubbles || false, inDict.cancelable || false);\n      e.preventTap = eventFactory.preventTap(e);\n      return e;\n    },\n    makeGestureEvent: function(inType, inDict) {\n      inDict = inDict || Object.create(null);\n\n      var e = this.makeBaseEvent(inType, inDict);\n      for (var i = 0, keys = Object.keys(inDict), k; i < keys.length; i++) {\n        k = keys[i];\n        e[k] = inDict[k];\n      }\n      return e;\n    },\n    makePointerEvent: function(inType, inDict) {\n      inDict = inDict || Object.create(null);\n\n      var e = this.makeBaseEvent(inType, inDict);\n      // define inherited MouseEvent properties\n      for(var i = 0, p; i < MOUSE_PROPS.length; i++) {\n        p = MOUSE_PROPS[i];\n        e[p] = inDict[p] || MOUSE_DEFAULTS[i];\n      }\n      e.buttons = inDict.buttons || 0;\n\n      // Spec requires that pointers without pressure specified use 0.5 for down\n      // state and 0 for up state.\n      var pressure = 0;\n      if (inDict.pressure) {\n        pressure = inDict.pressure;\n      } else {\n        pressure = e.buttons ? 0.5 : 0;\n      }\n\n      // add x/y properties aliased to clientX/Y\n      e.x = e.clientX;\n      e.y = e.clientY;\n\n      // define the properties of the PointerEvent interface\n      e.pointerId = inDict.pointerId || 0;\n      e.width = inDict.width || 0;\n      e.height = inDict.height || 0;\n      e.pressure = pressure;\n      e.tiltX = inDict.tiltX || 0;\n      e.tiltY = inDict.tiltY || 0;\n      e.pointerType = inDict.pointerType || '';\n      e.hwTimestamp = inDict.hwTimestamp || 0;\n      e.isPrimary = inDict.isPrimary || false;\n      return e;\n    }\n  };\n\n  scope.eventFactory = eventFactory;\n})(window.PolymerGestures);\n","/*\n * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * This module implements an map of pointer states\n */\n(function(scope) {\n  var USE_MAP = window.Map && window.Map.prototype.forEach;\n  var POINTERS_FN = function(){ return this.size; };\n  function PointerMap() {\n    if (USE_MAP) {\n      var m = new Map();\n      m.pointers = POINTERS_FN;\n      return m;\n    } else {\n      this.keys = [];\n      this.values = [];\n    }\n  }\n\n  PointerMap.prototype = {\n    set: function(inId, inEvent) {\n      var i = this.keys.indexOf(inId);\n      if (i > -1) {\n        this.values[i] = inEvent;\n      } else {\n        this.keys.push(inId);\n        this.values.push(inEvent);\n      }\n    },\n    has: function(inId) {\n      return this.keys.indexOf(inId) > -1;\n    },\n    'delete': function(inId) {\n      var i = this.keys.indexOf(inId);\n      if (i > -1) {\n        this.keys.splice(i, 1);\n        this.values.splice(i, 1);\n      }\n    },\n    get: function(inId) {\n      var i = this.keys.indexOf(inId);\n      return this.values[i];\n    },\n    clear: function() {\n      this.keys.length = 0;\n      this.values.length = 0;\n    },\n    // return value, key, map\n    forEach: function(callback, thisArg) {\n      this.values.forEach(function(v, i) {\n        callback.call(thisArg, v, this.keys[i], this);\n      }, this);\n    },\n    pointers: function() {\n      return this.keys.length;\n    }\n  };\n\n  scope.PointerMap = PointerMap;\n})(window.PolymerGestures);\n","/*\n * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n */\n\n(function(scope) {\n  var CLONE_PROPS = [\n    // MouseEvent\n    'bubbles',\n    'cancelable',\n    'view',\n    'detail',\n    'screenX',\n    'screenY',\n    'clientX',\n    'clientY',\n    'ctrlKey',\n    'altKey',\n    'shiftKey',\n    'metaKey',\n    'button',\n    'relatedTarget',\n    // DOM Level 3\n    'buttons',\n    // PointerEvent\n    'pointerId',\n    'width',\n    'height',\n    'pressure',\n    'tiltX',\n    'tiltY',\n    'pointerType',\n    'hwTimestamp',\n    'isPrimary',\n    // event instance\n    'type',\n    'target',\n    'currentTarget',\n    'which',\n    'pageX',\n    'pageY',\n    'timeStamp',\n    // gesture addons\n    'preventTap',\n    'tapPrevented'\n  ];\n\n  var CLONE_DEFAULTS = [\n    // MouseEvent\n    false,\n    false,\n    null,\n    null,\n    0,\n    0,\n    0,\n    0,\n    false,\n    false,\n    false,\n    false,\n    0,\n    null,\n    // DOM Level 3\n    0,\n    // PointerEvent\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    '',\n    0,\n    false,\n    // event instance\n    '',\n    null,\n    null,\n    0,\n    0,\n    0,\n    0,\n    function(){},\n    false\n  ];\n\n  var HAS_SVG_INSTANCE = (typeof SVGElementInstance !== 'undefined');\n\n  var eventFactory = scope.eventFactory;\n  /**\n   * This module is for normalizing events. Mouse and Touch events will be\n   * collected here, and fire PointerEvents that have the same semantics, no\n   * matter the source.\n   * Events fired:\n   *   - pointerdown: a pointing is added\n   *   - pointerup: a pointer is removed\n   *   - pointermove: a pointer is moved\n   *   - pointerover: a pointer crosses into an element\n   *   - pointerout: a pointer leaves an element\n   *   - pointercancel: a pointer will no longer generate events\n   */\n  var dispatcher = {\n    pointermap: new scope.PointerMap(),\n    eventMap: Object.create(null),\n    // Scope objects for native events.\n    // This exists for ease of testing.\n    eventSources: Object.create(null),\n    eventSourceList: [],\n    gestures: [],\n    gestureQueue: [],\n    /**\n     * Add a new event source that will generate pointer events.\n     *\n     * `inSource` must contain an array of event names named `events`, and\n     * functions with the names specified in the `events` array.\n     * @param {string} name A name for the event source\n     * @param {Object} source A new source of platform events.\n     */\n    registerSource: function(name, source) {\n      var s = source;\n      var newEvents = s.events;\n      if (newEvents) {\n        newEvents.forEach(function(e) {\n          if (s[e]) {\n            this.eventMap[e] = s[e].bind(s);\n          }\n        }, this);\n        this.eventSources[name] = s;\n        this.eventSourceList.push(s);\n      }\n    },\n    registerGesture: function(name, source) {\n      this.gestures.push(source);\n    },\n    register: function(element) {\n      var l = this.eventSourceList.length;\n      for (var i = 0, es; (i < l) && (es = this.eventSourceList[i]); i++) {\n        // call eventsource register\n        es.register.call(es, element);\n      }\n    },\n    unregister: function(element) {\n      var l = this.eventSourceList.length;\n      for (var i = 0, es; (i < l) && (es = this.eventSourceList[i]); i++) {\n        // call eventsource register\n        es.unregister.call(es, element);\n      }\n    },\n    // EVENTS\n    down: function(inEvent) {\n      this.fireEvent('down', inEvent);\n    },\n    move: function(inEvent) {\n      // pipe move events into gesture queue directly\n      inEvent.type = 'move';\n      this.fillGestureQueue(inEvent);\n    },\n    up: function(inEvent) {\n      this.fireEvent('up', inEvent);\n    },\n    cancel: function(inEvent) {\n      inEvent.tapPrevented = true;\n      this.fireEvent('up', inEvent);\n    },\n    // LISTENER LOGIC\n    eventHandler: function(inEvent) {\n      // This is used to prevent multiple dispatch of events from\n      // platform events. This can happen when two elements in different scopes\n      // are set up to create pointer events, which is relevant to Shadow DOM.\n      if (inEvent._handledByPG) {\n        return;\n      }\n      var type = inEvent.type;\n      var fn = this.eventMap && this.eventMap[type];\n      if (fn) {\n        fn(inEvent);\n      }\n      inEvent._handledByPG = true;\n    },\n    // set up event listeners\n    listen: function(target, events) {\n      events.forEach(function(e) {\n        this.addEvent(target, e);\n      }, this);\n    },\n    // remove event listeners\n    unlisten: function(target, events) {\n      events.forEach(function(e) {\n        this.removeEvent(target, e);\n      }, this);\n    },\n    addEvent: function(target, eventName) {\n      target.addEventListener(eventName, this.boundHandler);\n    },\n    removeEvent: function(target, eventName) {\n      target.removeEventListener(eventName, this.boundHandler);\n    },\n    // EVENT CREATION AND TRACKING\n    /**\n     * Creates a new Event of type `inType`, based on the information in\n     * `inEvent`.\n     *\n     * @param {string} inType A string representing the type of event to create\n     * @param {Event} inEvent A platform event with a target\n     * @return {Event} A PointerEvent of type `inType`\n     */\n    makeEvent: function(inType, inEvent) {\n      var e = eventFactory.makePointerEvent(inType, inEvent);\n      e.preventDefault = inEvent.preventDefault;\n      e.tapPrevented = inEvent.tapPrevented;\n      e._target = e._target || inEvent.target;\n      return e;\n    },\n    // make and dispatch an event in one call\n    fireEvent: function(inType, inEvent) {\n      var e = this.makeEvent(inType, inEvent);\n      return this.dispatchEvent(e);\n    },\n    /**\n     * Returns a snapshot of inEvent, with writable properties.\n     *\n     * @param {Event} inEvent An event that contains properties to copy.\n     * @return {Object} An object containing shallow copies of `inEvent`'s\n     *    properties.\n     */\n    cloneEvent: function(inEvent) {\n      var eventCopy = Object.create(null), p;\n      for (var i = 0; i < CLONE_PROPS.length; i++) {\n        p = CLONE_PROPS[i];\n        eventCopy[p] = inEvent[p] || CLONE_DEFAULTS[i];\n        // Work around SVGInstanceElement shadow tree\n        // Return the <use> element that is represented by the instance for Safari, Chrome, IE.\n        // This is the behavior implemented by Firefox.\n        if (HAS_SVG_INSTANCE && (p === 'target' || p === 'relatedTarget')) {\n          if (eventCopy[p] instanceof SVGElementInstance) {\n            eventCopy[p] = eventCopy[p].correspondingUseElement;\n          }\n        }\n      }\n      // keep the semantics of preventDefault\n      eventCopy.preventDefault = inEvent.preventDefault;\n      return eventCopy;\n    },\n    /**\n     * Dispatches the event to its target.\n     *\n     * @param {Event} inEvent The event to be dispatched.\n     * @return {Boolean} True if an event handler returns true, false otherwise.\n     */\n    dispatchEvent: function(inEvent) {\n      var t = inEvent._target;\n      if (t) {\n        t.dispatchEvent(inEvent);\n        // clone the event for the gesture system to process\n        // clone after dispatch to pick up gesture prevention code\n        var clone = this.cloneEvent(inEvent);\n        clone.target = inEvent._target;\n        this.fillGestureQueue(clone);\n      }\n    },\n    gestureTrigger: function() {\n      // process the gesture queue\n      for (var i = 0, e; i < this.gestureQueue.length; i++) {\n        e = this.gestureQueue[i];\n        for (var j = 0, g; j < this.gestures.length; j++) {\n          g = this.gestures[j];\n          if (g.events.indexOf(e.type) >= 0) {\n            g[e.type].call(g, e);\n          }\n        }\n      }\n      this.gestureQueue.length = 0;\n    },\n    fillGestureQueue: function(ev) {\n      // only trigger the gesture queue once\n      if (!this.gestureQueue.length) {\n        requestAnimationFrame(this.boundGestureTrigger);\n      }\n      this.gestureQueue.push(ev);\n    }\n  };\n  dispatcher.boundHandler = dispatcher.eventHandler.bind(dispatcher);\n  dispatcher.boundGestureTrigger = dispatcher.gestureTrigger.bind(dispatcher);\n  scope.dispatcher = dispatcher;\n  scope.register = dispatcher.register.bind(dispatcher);\n  scope.unregister = dispatcher.unregister.bind(dispatcher);\n})(window.PolymerGestures);\n","/*\n * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * This module uses Mutation Observers to dynamically adjust which nodes will\n * generate Pointer Events.\n *\n * All nodes that wish to generate Pointer Events must have the attribute\n * `touch-action` set to `none`.\n */\n(function(scope) {\n  var forEach = Array.prototype.forEach.call.bind(Array.prototype.forEach);\n  var map = Array.prototype.map.call.bind(Array.prototype.map);\n  var toArray = Array.prototype.slice.call.bind(Array.prototype.slice);\n  var filter = Array.prototype.filter.call.bind(Array.prototype.filter);\n  var MO = window.MutationObserver || window.WebKitMutationObserver;\n  var SELECTOR = '[touch-action]';\n  var OBSERVER_INIT = {\n    subtree: true,\n    childList: true,\n    attributes: true,\n    attributeOldValue: true,\n    attributeFilter: ['touch-action']\n  };\n\n  function Installer(add, remove, changed, binder) {\n    this.addCallback = add.bind(binder);\n    this.removeCallback = remove.bind(binder);\n    this.changedCallback = changed.bind(binder);\n    if (MO) {\n      this.observer = new MO(this.mutationWatcher.bind(this));\n    }\n  }\n\n  Installer.prototype = {\n    watchSubtree: function(target) {\n      // Only watch scopes that can target find, as these are top-level.\n      // Otherwise we can see duplicate additions and removals that add noise.\n      //\n      // TODO(dfreedman): For some instances with ShadowDOMPolyfill, we can see\n      // a removal without an insertion when a node is redistributed among\n      // shadows. Since it all ends up correct in the document, watching only\n      // the document will yield the correct mutations to watch.\n      if (scope.targetFinding.canTarget(target)) {\n        this.observer.observe(target, OBSERVER_INIT);\n      }\n    },\n    enableOnSubtree: function(target) {\n      this.watchSubtree(target);\n      if (target === document && document.readyState !== 'complete') {\n        this.installOnLoad();\n      } else {\n        this.installNewSubtree(target);\n      }\n    },\n    installNewSubtree: function(target) {\n      forEach(this.findElements(target), this.addElement, this);\n    },\n    findElements: function(target) {\n      if (target.querySelectorAll) {\n        return target.querySelectorAll(SELECTOR);\n      }\n      return [];\n    },\n    removeElement: function(el) {\n      this.removeCallback(el);\n    },\n    addElement: function(el) {\n      this.addCallback(el);\n    },\n    elementChanged: function(el, oldValue) {\n      this.changedCallback(el, oldValue);\n    },\n    concatLists: function(accum, list) {\n      return accum.concat(toArray(list));\n    },\n    // register all touch-action = none nodes on document load\n    installOnLoad: function() {\n      document.addEventListener('readystatechange', function() {\n        if (document.readyState === 'complete') {\n          this.installNewSubtree(document);\n        }\n      }.bind(this));\n    },\n    isElement: function(n) {\n      return n.nodeType === Node.ELEMENT_NODE;\n    },\n    flattenMutationTree: function(inNodes) {\n      // find children with touch-action\n      var tree = map(inNodes, this.findElements, this);\n      // make sure the added nodes are accounted for\n      tree.push(filter(inNodes, this.isElement));\n      // flatten the list\n      return tree.reduce(this.concatLists, []);\n    },\n    mutationWatcher: function(mutations) {\n      mutations.forEach(this.mutationHandler, this);\n    },\n    mutationHandler: function(m) {\n      if (m.type === 'childList') {\n        var added = this.flattenMutationTree(m.addedNodes);\n        added.forEach(this.addElement, this);\n        var removed = this.flattenMutationTree(m.removedNodes);\n        removed.forEach(this.removeElement, this);\n      } else if (m.type === 'attributes') {\n        this.elementChanged(m.target, m.oldValue);\n      }\n    }\n  };\n\n  if (!MO) {\n    Installer.prototype.watchSubtree = function(){\n      console.warn('PolymerGestures: MutationObservers not found, touch-action will not be dynamically detected');\n    };\n  }\n\n  scope.Installer = Installer;\n})(window.PolymerGestures);\n","/*\n * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n */\n\n(function (scope) {\n  var dispatcher = scope.dispatcher;\n  var pointermap = dispatcher.pointermap;\n  // radius around touchend that swallows mouse events\n  var DEDUP_DIST = 25;\n\n  var WHICH_TO_BUTTONS = [0, 1, 4, 2];\n\n  var HAS_BUTTONS = false;\n  try {\n    HAS_BUTTONS = new MouseEvent('test', {buttons: 1}).buttons === 1;\n  } catch (e) {}\n\n  // handler block for native mouse events\n  var mouseEvents = {\n    POINTER_ID: 1,\n    POINTER_TYPE: 'mouse',\n    events: [\n      'mousedown',\n      'mousemove',\n      'mouseup',\n    ],\n    register: function(target) {\n      dispatcher.listen(target, this.events);\n    },\n    unregister: function(target) {\n      dispatcher.unlisten(target, this.events);\n    },\n    lastTouches: [],\n    // collide with the global mouse listener\n    isEventSimulatedFromTouch: function(inEvent) {\n      var lts = this.lastTouches;\n      var x = inEvent.clientX, y = inEvent.clientY;\n      for (var i = 0, l = lts.length, t; i < l && (t = lts[i]); i++) {\n        // simulated mouse events will be swallowed near a primary touchend\n        var dx = Math.abs(x - t.x), dy = Math.abs(y - t.y);\n        if (dx <= DEDUP_DIST && dy <= DEDUP_DIST) {\n          return true;\n        }\n      }\n    },\n    prepareEvent: function(inEvent) {\n      var e = dispatcher.cloneEvent(inEvent);\n      e.pointerId = this.POINTER_ID;\n      e.isPrimary = true;\n      e.pointerType = this.POINTER_TYPE;\n      if (!HAS_BUTTONS) {\n        e.buttons = WHICH_TO_BUTTONS[e.which] || 0;\n      }\n      return e;\n    },\n    mousedown: function(inEvent) {\n      if (!this.isEventSimulatedFromTouch(inEvent)) {\n        var p = pointermap.has(this.POINTER_ID);\n        // TODO(dfreedman) workaround for some elements not sending mouseup\n        // http://crbug/149091\n        if (p) {\n          this.mouseup(inEvent);\n        }\n        var e = this.prepareEvent(inEvent);\n        pointermap.set(this.POINTER_ID, inEvent.target);\n        dispatcher.down(e);\n      }\n    },\n    mousemove: function(inEvent) {\n      if (!this.isEventSimulatedFromTouch(inEvent)) {\n        var e = this.prepareEvent(inEvent);\n        e.target = pointermap.get(this.POINTER_ID);\n        dispatcher.move(e);\n      }\n    },\n    mouseup: function(inEvent) {\n      if (!this.isEventSimulatedFromTouch(inEvent)) {\n        var e = this.prepareEvent(inEvent);\n        e.target = pointermap.get(this.POINTER_ID);\n        e.relatedTarget = inEvent.target;\n        dispatcher.up(e);\n        this.cleanupMouse();\n      }\n    },\n    cleanupMouse: function() {\n      pointermap['delete'](this.POINTER_ID);\n    }\n  };\n\n  scope.mouseEvents = mouseEvents;\n})(window.PolymerGestures);\n","/*\n * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n */\n\n(function(scope) {\n  var dispatcher = scope.dispatcher;\n  var allShadows = scope.targetFinding.allShadows.bind(scope.targetFinding);\n  var pointermap = dispatcher.pointermap;\n  var touchMap = Array.prototype.map.call.bind(Array.prototype.map);\n  // This should be long enough to ignore compat mouse events made by touch\n  var DEDUP_TIMEOUT = 2500;\n  var CLICK_COUNT_TIMEOUT = 200;\n  var ATTRIB = 'touch-action';\n  var INSTALLER;\n  var HAS_TOUCH_ACTION = typeof document.head.style.touchAction === 'string';\n\n  // handler block for native touch events\n  var touchEvents = {\n    events: [\n      'touchstart',\n      'touchmove',\n      'touchend',\n      'touchcancel'\n    ],\n    register: function(target) {\n      if (HAS_TOUCH_ACTION) {\n        dispatcher.listen(target, this.events);\n      } else {\n        INSTALLER.enableOnSubtree(target);\n      }\n    },\n    unregister: function(target) {\n      if (HAS_TOUCH_ACTION) {\n        dispatcher.unlisten(target, this.events);\n      } else {\n        // TODO(dfreedman): is it worth it to disconnect the MO?\n      }\n    },\n    elementAdded: function(el) {\n      var a = el.getAttribute(ATTRIB);\n      var st = this.touchActionToScrollType(a);\n      if (st) {\n        el._scrollType = st;\n        dispatcher.listen(el, this.events);\n        // set touch-action on shadows as well\n        allShadows(el).forEach(function(s) {\n          s._scrollType = st;\n          dispatcher.listen(s, this.events);\n        }, this);\n      }\n    },\n    elementRemoved: function(el) {\n      el._scrollType = undefined;\n      dispatcher.unlisten(el, this.events);\n      // remove touch-action from shadow\n      allShadows(el).forEach(function(s) {\n        s._scrollType = undefined;\n        dispatcher.unlisten(s, this.events);\n      }, this);\n    },\n    elementChanged: function(el, oldValue) {\n      var a = el.getAttribute(ATTRIB);\n      var st = this.touchActionToScrollType(a);\n      var oldSt = this.touchActionToScrollType(oldValue);\n      // simply update scrollType if listeners are already established\n      if (st && oldSt) {\n        el._scrollType = st;\n        allShadows(el).forEach(function(s) {\n          s._scrollType = st;\n        }, this);\n      } else if (oldSt) {\n        this.elementRemoved(el);\n      } else if (st) {\n        this.elementAdded(el);\n      }\n    },\n    scrollTypes: {\n      EMITTER: 'none',\n      XSCROLLER: 'pan-x',\n      YSCROLLER: 'pan-y',\n      SCROLLER: /^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/\n    },\n    touchActionToScrollType: function(touchAction) {\n      var t = touchAction;\n      var st = this.scrollTypes;\n      if (t === 'none') {\n        return 'none';\n      } else if (t === st.XSCROLLER) {\n        return 'X';\n      } else if (t === st.YSCROLLER) {\n        return 'Y';\n      } else if (st.SCROLLER.exec(t)) {\n        return 'XY';\n      }\n    },\n    POINTER_TYPE: 'touch',\n    firstTouch: null,\n    isPrimaryTouch: function(inTouch) {\n      return this.firstTouch === inTouch.identifier;\n    },\n    setPrimaryTouch: function(inTouch) {\n      // set primary touch if there no pointers, or the only pointer is the mouse\n      if (pointermap.pointers() === 0 || (pointermap.pointers() === 1 && pointermap.has(1))) {\n        this.firstTouch = inTouch.identifier;\n        this.firstXY = {X: inTouch.clientX, Y: inTouch.clientY};\n        this.scrolling = false;\n        this.cancelResetClickCount();\n      }\n    },\n    removePrimaryPointer: function(inPointer) {\n      if (inPointer.isPrimary) {\n        this.firstTouch = null;\n        this.firstXY = null;\n        this.resetClickCount();\n      }\n    },\n    clickCount: 0,\n    resetId: null,\n    resetClickCount: function() {\n      var fn = function() {\n        this.clickCount = 0;\n        this.resetId = null;\n      }.bind(this);\n      this.resetId = setTimeout(fn, CLICK_COUNT_TIMEOUT);\n    },\n    cancelResetClickCount: function() {\n      if (this.resetId) {\n        clearTimeout(this.resetId);\n      }\n    },\n    typeToButtons: function(type) {\n      var ret = 0;\n      if (type === 'touchstart' || type === 'touchmove') {\n        ret = 1;\n      }\n      return ret;\n    },\n    findTarget: function(touch, id) {\n      if (this.currentTouchEvent.type === 'touchstart') {\n        return scope.findTarget(touch);\n      }\n      // reuse target we found in touchstart\n      return pointermap.get(id);\n    },\n    touchToPointer: function(inTouch) {\n      var cte = this.currentTouchEvent;\n      var e = dispatcher.cloneEvent(inTouch);\n      // Spec specifies that pointerId 1 is reserved for Mouse.\n      // Touch identifiers can start at 0.\n      // Add 2 to the touch identifier for compatibility.\n      var id = e.pointerId = inTouch.identifier + 2;\n      e.target = this.findTarget(inTouch, id);\n      e.bubbles = true;\n      e.cancelable = true;\n      e.detail = this.clickCount;\n      e.buttons = this.typeToButtons(cte.type);\n      e.width = inTouch.webkitRadiusX || inTouch.radiusX || 0;\n      e.height = inTouch.webkitRadiusY || inTouch.radiusY || 0;\n      e.pressure = inTouch.webkitForce || inTouch.force || 0.5;\n      e.isPrimary = this.isPrimaryTouch(inTouch);\n      e.pointerType = this.POINTER_TYPE;\n      // forward touch preventDefaults\n      var self = this;\n      e.preventDefault = function() {\n        self.scrolling = false;\n        self.firstXY = null;\n        cte.preventDefault();\n      };\n      return e;\n    },\n    processTouches: function(inEvent, inFunction) {\n      var tl = inEvent.changedTouches;\n      this.currentTouchEvent = inEvent;\n      for (var i = 0, t; i < tl.length; i++) {\n        t = tl[i];\n        inFunction.call(this, this.touchToPointer(t));\n      }\n    },\n    // For single axis scrollers, determines whether the element should emit\n    // pointer events or behave as a scroller\n    shouldScroll: function(inEvent) {\n      if (this.firstXY) {\n        var ret;\n        var scrollAxis = inEvent.currentTarget._scrollType;\n        if (scrollAxis === 'none') {\n          // this element is a touch-action: none, should never scroll\n          ret = false;\n        } else if (scrollAxis === 'XY') {\n          // this element should always scroll\n          ret = true;\n        } else {\n          var t = inEvent.changedTouches[0];\n          // check the intended scroll axis, and other axis\n          var a = scrollAxis;\n          var oa = scrollAxis === 'Y' ? 'X' : 'Y';\n          var da = Math.abs(t['client' + a] - this.firstXY[a]);\n          var doa = Math.abs(t['client' + oa] - this.firstXY[oa]);\n          // if delta in the scroll axis > delta other axis, scroll instead of\n          // making events\n          ret = da >= doa;\n        }\n        this.firstXY = null;\n        return ret;\n      }\n    },\n    findTouch: function(inTL, inId) {\n      for (var i = 0, l = inTL.length, t; i < l && (t = inTL[i]); i++) {\n        if (t.identifier === inId) {\n          return true;\n        }\n      }\n    },\n    // In some instances, a touchstart can happen without a touchend. This\n    // leaves the pointermap in a broken state.\n    // Therefore, on every touchstart, we remove the touches that did not fire a\n    // touchend event.\n    // To keep state globally consistent, we fire a\n    // pointercancel for this \"abandoned\" touch\n    vacuumTouches: function(inEvent) {\n      var tl = inEvent.touches;\n      // pointermap.pointers() should be < tl.length here, as the touchstart has not\n      // been processed yet.\n      if (pointermap.pointers() >= tl.length) {\n        var d = [];\n        pointermap.forEach(function(value, key) {\n          // Never remove pointerId == 1, which is mouse.\n          // Touch identifiers are 2 smaller than their pointerId, which is the\n          // index in pointermap.\n          if (key !== 1 && !this.findTouch(tl, key - 2)) {\n            var p = value.out;\n            d.push(p);\n          }\n        }, this);\n        d.forEach(this.cancelOut, this);\n      }\n    },\n    touchstart: function(inEvent) {\n      this.vacuumTouches(inEvent);\n      this.setPrimaryTouch(inEvent.changedTouches[0]);\n      this.dedupSynthMouse(inEvent);\n      if (!this.scrolling) {\n        this.clickCount++;\n        this.processTouches(inEvent, this.down);\n      }\n    },\n    down: function(inPointer) {\n      var p = pointermap.set(inPointer.pointerId, inPointer.target);\n      dispatcher.down(inPointer);\n    },\n    touchmove: function(inEvent) {\n      if (HAS_TOUCH_ACTION) {\n        this.processTouches(inEvent, this.move);\n      } else {\n        if (!this.scrolling) {\n          if (this.shouldScroll(inEvent)) {\n            this.scrolling = true;\n            this.touchcancel(inEvent);\n          } else {\n            inEvent.preventDefault();\n            this.processTouches(inEvent, this.move);\n          }\n        }\n      }\n    },\n    move: function(inPointer) {\n      var pointer = pointermap.get(inPointer.pointerId);\n      // a finger drifted off the screen, ignore it\n      if (!pointer) {\n        return;\n      }\n      dispatcher.move(inPointer);\n    },\n    touchend: function(inEvent) {\n      this.dedupSynthMouse(inEvent);\n      this.processTouches(inEvent, this.up);\n    },\n    up: function(inPointer) {\n      if (!this.scrolling) {\n        inPointer.relatedTarget = scope.findTarget(inPointer);\n        dispatcher.up(inPointer);\n      }\n      this.cleanUpPointer(inPointer);\n    },\n    cancel: function(inPointer) {\n      inPointer.relatedTarget = scope.findTarget(inPointer);\n      dispatcher.cancel(inPointer);\n      this.cleanUpPointer(inPointer);\n    },\n    touchcancel: function(inEvent) {\n      this.processTouches(inEvent, this.cancel);\n    },\n    cleanUpPointer: function(inPointer) {\n      pointermap['delete'](inPointer.pointerId);\n      this.removePrimaryPointer(inPointer);\n    },\n    // prevent synth mouse events from creating pointer events\n    dedupSynthMouse: function(inEvent) {\n      var lts = scope.mouseEvents.lastTouches;\n      var t = inEvent.changedTouches[0];\n      // only the primary finger will synth mouse events\n      if (this.isPrimaryTouch(t)) {\n        // remember x/y of last touch\n        var lt = {x: t.clientX, y: t.clientY};\n        lts.push(lt);\n        var fn = (function(lts, lt){\n          var i = lts.indexOf(lt);\n          if (i > -1) {\n            lts.splice(i, 1);\n          }\n        }).bind(null, lts, lt);\n        setTimeout(fn, DEDUP_TIMEOUT);\n      }\n    }\n  };\n\n  if (!HAS_TOUCH_ACTION) {\n    INSTALLER = new scope.Installer(touchEvents.elementAdded, touchEvents.elementRemoved, touchEvents.elementChanged, touchEvents);\n  }\n\n  scope.touchEvents = touchEvents;\n})(window.PolymerGestures);\n","/*\n * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n */\n\n(function(scope) {\n  var dispatcher = scope.dispatcher;\n  var pointermap = dispatcher.pointermap;\n  var HAS_BITMAP_TYPE = window.MSPointerEvent && typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE === 'number';\n  var msEvents = {\n    events: [\n      'MSPointerDown',\n      'MSPointerMove',\n      'MSPointerUp',\n      'MSPointerCancel',\n    ],\n    register: function(target) {\n      dispatcher.listen(target, this.events);\n    },\n    unregister: function(target) {\n      dispatcher.unlisten(target, this.events);\n    },\n    POINTER_TYPES: [\n      '',\n      'unavailable',\n      'touch',\n      'pen',\n      'mouse'\n    ],\n    prepareEvent: function(inEvent) {\n      var e = inEvent;\n      if (HAS_BITMAP_TYPE) {\n        e = dispatcher.cloneEvent(inEvent);\n        e.pointerType = this.POINTER_TYPES[inEvent.pointerType];\n      }\n      return e;\n    },\n    cleanup: function(id) {\n      pointermap['delete'](id);\n    },\n    MSPointerDown: function(inEvent) {\n      pointermap.set(inEvent.pointerId, inEvent.target);\n      var e = this.prepareEvent(inEvent);\n      dispatcher.down(e);\n    },\n    MSPointerMove: function(inEvent) {\n      var e = this.prepareEvent(inEvent);\n      e.target = pointermap.get(inEvent.pointerId);\n      dispatcher.move(e);\n    },\n    MSPointerUp: function(inEvent) {\n      var e = this.prepareEvent(inEvent);\n      e.target = pointermap.get(inEvent.pointerId);\n      e.relatedTarget = inEvent.target;\n      dispatcher.up(e);\n      this.cleanup(inEvent.pointerId);\n    },\n    MSPointerCancel: function(inEvent) {\n      var e = this.prepareEvent(inEvent);\n      e.target = pointermap.get(inEvent.pointerId);\n      e.relatedTarget = inEvent.target;\n      dispatcher.cancel(e);\n      this.cleanup(inEvent.pointerId);\n    }\n  };\n\n  scope.msEvents = msEvents;\n})(window.PolymerGestures);\n","/*\n * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n */\n\n(function(scope) {\n  var dispatcher = scope.dispatcher;\n  var pointermap = dispatcher.pointermap;\n  var pointerEvents = {\n    events: [\n      'pointerdown',\n      'pointermove',\n      'pointerup',\n      'pointercancel'\n    ],\n    prepareEvent: function(inEvent) {\n      return dispatcher.cloneEvent(inEvent);\n    },\n    register: function(target) {\n      dispatcher.listen(target, this.events);\n    },\n    unregister: function(target) {\n      dispatcher.unlisten(target, this.events);\n    },\n    cleanup: function(id) {\n      pointermap['delete'](id);\n    },\n    pointerdown: function(inEvent) {\n      pointermap.set(inEvent.pointerId, inEvent.target);\n      var e = this.prepareEvent(inEvent);\n      dispatcher.down(e);\n    },\n    pointermove: function(inEvent) {\n      var e = this.prepareEvent(inEvent);\n      e.target = pointermap.get(inEvent.pointerId);\n      dispatcher.move(e);\n    },\n    pointerup: function(inEvent) {\n      var e = this.prepareEvent(inEvent);\n      e.target = pointermap.get(inEvent.pointerId);\n      e.relatedTarget = inEvent.target;\n      dispatcher.up(e);\n      this.cleanup(inEvent.pointerId);\n    },\n    pointercancel: function(inEvent) {\n      var e = this.prepareEvent(inEvent);\n      e.target = pointermap.get(inEvent.pointerId);\n      e.relatedTarget = inEvent.target;\n      dispatcher.cancel(e);\n      this.cleanup(inEvent.pointerId);\n    }\n  };\n\n  scope.pointerEvents = pointerEvents;\n})(window.PolymerGestures);\n","/*\n * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * This module contains the handlers for native platform events.\n * From here, the dispatcher is called to create unified pointer events.\n * Included are touch events (v1), mouse events, and MSPointerEvents.\n */\n(function(scope) {\n  var dispatcher = scope.dispatcher;\n\n  if (window.PointerEvent) {\n    dispatcher.registerSource('pointer', scope.pointerEvents);\n  } else if (window.navigator.msPointerEnabled) {\n    dispatcher.registerSource('ms', scope.msEvents);\n  } else {\n    dispatcher.registerSource('mouse', scope.mouseEvents);\n    if (window.ontouchstart !== undefined) {\n      dispatcher.registerSource('touch', scope.touchEvents);\n    }\n  }\n\n  dispatcher.register(document);\n})(window.PolymerGestures);\n","/*\n * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * This event denotes the beginning of a series of tracking events.\n *\n * @module PointerGestures\n * @submodule Events\n * @class trackstart\n */\n/**\n * Pixels moved in the x direction since trackstart.\n * @type Number\n * @property dx\n */\n/**\n * Pixes moved in the y direction since trackstart.\n * @type Number\n * @property dy\n */\n/**\n * Pixels moved in the x direction since the last track.\n * @type Number\n * @property ddx\n */\n/**\n * Pixles moved in the y direction since the last track.\n * @type Number\n * @property ddy\n */\n/**\n * The clientX position of the track gesture.\n * @type Number\n * @property clientX\n */\n/**\n * The clientY position of the track gesture.\n * @type Number\n * @property clientY\n */\n/**\n * The pageX position of the track gesture.\n * @type Number\n * @property pageX\n */\n/**\n * The pageY position of the track gesture.\n * @type Number\n * @property pageY\n */\n/**\n * The screenX position of the track gesture.\n * @type Number\n * @property screenX\n */\n/**\n * The screenY position of the track gesture.\n * @type Number\n * @property screenY\n */\n/**\n * The last x axis direction of the pointer.\n * @type Number\n * @property xDirection\n */\n/**\n * The last y axis direction of the pointer.\n * @type Number\n * @property yDirection\n */\n/**\n * A shared object between all tracking events.\n * @type Object\n * @property trackInfo\n */\n/**\n * The element currently under the pointer.\n * @type Element\n * @property relatedTarget\n */\n/**\n * The type of pointer that make the track gesture.\n * @type String\n * @property pointerType\n */\n/**\n *\n * This event fires for all pointer movement being tracked.\n *\n * @class track\n * @extends trackstart\n */\n/**\n * This event fires when the pointer is no longer being tracked.\n *\n * @class trackend\n * @extends trackstart\n */\n\n (function(scope) {\n   var dispatcher = scope.dispatcher;\n   var eventFactory = scope.eventFactory;\n   var pointermap = new scope.PointerMap();\n   var track = {\n     events: [\n       'down',\n       'move',\n       'up',\n     ],\n     WIGGLE_THRESHOLD: 4,\n     clampDir: function(inDelta) {\n       return inDelta > 0 ? 1 : -1;\n     },\n     calcPositionDelta: function(inA, inB) {\n       var x = 0, y = 0;\n       if (inA && inB) {\n         x = inB.pageX - inA.pageX;\n         y = inB.pageY - inA.pageY;\n       }\n       return {x: x, y: y};\n     },\n     fireTrack: function(inType, inEvent, inTrackingData) {\n       var t = inTrackingData;\n       var d = this.calcPositionDelta(t.downEvent, inEvent);\n       var dd = this.calcPositionDelta(t.lastMoveEvent, inEvent);\n       if (dd.x) {\n         t.xDirection = this.clampDir(dd.x);\n       }\n       if (dd.y) {\n         t.yDirection = this.clampDir(dd.y);\n       }\n       var e = eventFactory.makeGestureEvent(inType, {\n         bubbles: true,\n         cancelable: true,\n         dx: d.x,\n         dy: d.y,\n         ddx: dd.x,\n         ddy: dd.y,\n         x: inEvent.x,\n         y: inEvent.y,\n         clientX: inEvent.clientX,\n         clientY: inEvent.clientY,\n         pageX: inEvent.pageX,\n         pageY: inEvent.pageY,\n         screenX: inEvent.screenX,\n         screenY: inEvent.screenY,\n         xDirection: t.xDirection,\n         yDirection: t.yDirection,\n         trackInfo: t.trackInfo,\n         relatedTarget: inEvent.relatedTarget,\n         pointerType: inEvent.pointerType,\n         pointerId: inEvent.pointerId\n       });\n       t.downTarget.dispatchEvent(e);\n     },\n     down: function(inEvent) {\n       if (inEvent.isPrimary && (inEvent.pointerType === 'mouse' ? inEvent.buttons === 1 : true)) {\n         var p = {\n           downEvent: inEvent,\n           downTarget: inEvent.target,\n           trackInfo: {},\n           lastMoveEvent: null,\n           xDirection: 0,\n           yDirection: 0,\n           tracking: false\n         };\n         pointermap.set(inEvent.pointerId, p);\n       }\n     },\n     move: function(inEvent) {\n       var p = pointermap.get(inEvent.pointerId);\n       if (p) {\n         if (!p.tracking) {\n           var d = this.calcPositionDelta(p.downEvent, inEvent);\n           var move = d.x * d.x + d.y * d.y;\n           // start tracking only if finger moves more than WIGGLE_THRESHOLD\n           if (move > this.WIGGLE_THRESHOLD) {\n             p.tracking = true;\n             this.fireTrack('trackstart', p.downEvent, p);\n             this.fireTrack('track', inEvent, p);\n           }\n         } else {\n           this.fireTrack('track', inEvent, p);\n         }\n         p.lastMoveEvent = inEvent;\n       }\n     },\n     up: function(inEvent) {\n       var p = pointermap.get(inEvent.pointerId);\n       if (p) {\n         if (p.tracking) {\n           this.fireTrack('trackend', inEvent, p);\n         }\n         pointermap.delete(inEvent.pointerId);\n       }\n     }\n   };\n   dispatcher.registerGesture('track', track);\n })(window.PolymerGestures);\n","/*\n * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * This event is fired when a pointer is held down for 200ms.\n *\n * @module PointerGestures\n * @submodule Events\n * @class hold\n */\n/**\n * Type of pointer that made the holding event.\n * @type String\n * @property pointerType\n */\n/**\n * Screen X axis position of the held pointer\n * @type Number\n * @property clientX\n */\n/**\n * Screen Y axis position of the held pointer\n * @type Number\n * @property clientY\n */\n/**\n * Type of pointer that made the holding event.\n * @type String\n * @property pointerType\n */\n/**\n * This event is fired every 200ms while a pointer is held down.\n *\n * @class holdpulse\n * @extends hold\n */\n/**\n * Milliseconds pointer has been held down.\n * @type Number\n * @property holdTime\n */\n/**\n * This event is fired when a held pointer is released or moved.\n *\n * @class released\n */\n\n(function(scope) {\n  var dispatcher = scope.dispatcher;\n  var eventFactory = scope.eventFactory;\n  var hold = {\n    // wait at least HOLD_DELAY ms between hold and pulse events\n    HOLD_DELAY: 200,\n    // pointer can move WIGGLE_THRESHOLD pixels before not counting as a hold\n    WIGGLE_THRESHOLD: 16,\n    events: [\n      'down',\n      'move',\n      'up',\n    ],\n    heldPointer: null,\n    holdJob: null,\n    pulse: function() {\n      var hold = Date.now() - this.heldPointer.timeStamp;\n      var type = this.held ? 'holdpulse' : 'hold';\n      this.fireHold(type, hold);\n      this.held = true;\n    },\n    cancel: function() {\n      clearInterval(this.holdJob);\n      if (this.held) {\n        this.fireHold('release');\n      }\n      this.held = false;\n      this.heldPointer = null;\n      this.target = null;\n      this.holdJob = null;\n    },\n    down: function(inEvent) {\n      if (inEvent.isPrimary && !this.heldPointer) {\n        this.heldPointer = inEvent;\n        this.target = inEvent.target;\n        this.holdJob = setInterval(this.pulse.bind(this), this.HOLD_DELAY);\n      }\n    },\n    up: function(inEvent) {\n      if (this.heldPointer && this.heldPointer.pointerId === inEvent.pointerId) {\n        this.cancel();\n      }\n    },\n    move: function(inEvent) {\n      if (this.heldPointer && this.heldPointer.pointerId === inEvent.pointerId) {\n        var x = inEvent.clientX - this.heldPointer.clientX;\n        var y = inEvent.clientY - this.heldPointer.clientY;\n        if ((x * x + y * y) > this.WIGGLE_THRESHOLD) {\n          this.cancel();\n        }\n      }\n    },\n    fireHold: function(inType, inHoldTime) {\n      var p = {\n        bubbles: true,\n        cancelable: true,\n        pointerType: this.heldPointer.pointerType,\n        pointerId: this.heldPointer.pointerId,\n        x: this.heldPointer.clientX,\n        y: this.heldPointer.clientY\n      };\n      if (inHoldTime) {\n        p.holdTime = inHoldTime;\n      }\n      var e = eventFactory.makeGestureEvent(inType, p);\n      this.target.dispatchEvent(e);\n    }\n  };\n  dispatcher.registerGesture('hold', hold);\n})(window.PolymerGestures);\n","/*\n * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * This event is fired when a pointer quickly goes down and up, and is used to\n * denote activation.\n *\n * Any gesture event can prevent the tap event from being created by calling\n * `event.preventTap`.\n *\n * Any pointer event can prevent the tap by setting the `tapPrevented` property\n * on itself.\n *\n * @module PointerGestures\n * @submodule Events\n * @class tap\n */\n/**\n * X axis position of the tap.\n * @property x\n * @type Number\n */\n/**\n * Y axis position of the tap.\n * @property y\n * @type Number\n */\n/**\n * Type of the pointer that made the tap.\n * @property pointerType\n * @type String\n */\n(function(scope) {\n  var dispatcher = scope.dispatcher;\n  var eventFactory = scope.eventFactory;\n  var pointermap = new scope.PointerMap();\n  var tap = {\n    events: [\n      'down',\n      'up'\n    ],\n    down: function(inEvent) {\n      if (inEvent.isPrimary && !inEvent.tapPrevented) {\n        pointermap.set(inEvent.pointerId, {\n          target: inEvent.target,\n          buttons: inEvent.buttons,\n          x: inEvent.clientX,\n          y: inEvent.clientY\n        });\n      }\n    },\n    shouldTap: function(e, downState) {\n      if (e.pointerType === 'mouse') {\n        // only allow left click to tap for mouse\n        return downState.buttons === 1;\n      }\n      return !e.tapPrevented;\n    },\n    up: function(inEvent) {\n      var start = pointermap.get(inEvent.pointerId);\n      if (start && this.shouldTap(inEvent, start)) {\n        // up.relatedTarget is target currently under finger\n        var t = scope.targetFinding.LCA(start.target, inEvent.relatedTarget);\n        if (t) {\n          var e = eventFactory.makeGestureEvent('tap', {\n            bubbles: true,\n            cancelable: true,\n            x: inEvent.clientX,\n            y: inEvent.clientY,\n            detail: inEvent.detail,\n            pointerType: inEvent.pointerType,\n            pointerId: inEvent.pointerId,\n            altKey: inEvent.altKey,\n            ctrlKey: inEvent.ctrlKey,\n            metaKey: inEvent.metaKey,\n            shiftKey: inEvent.shiftKey\n          });\n          t.dispatchEvent(e);\n        }\n      }\n      pointermap.delete(inEvent.pointerId);\n    }\n  };\n  // patch eventFactory to remove id from tap's pointermap for preventTap calls\n  eventFactory.preventTap = function(e) {\n    return function() {\n      e.tapPrevented = true;\n      pointermap.delete(e.pointerId);\n    };\n  };\n  dispatcher.registerGesture('tap', tap);\n})(window.PolymerGestures);\n","/*\n  Copyright (C) 2013 Ariya Hidayat <ariya.hidayat@gmail.com>\n  Copyright (C) 2013 Thaddee Tyl <thaddee.tyl@gmail.com>\n  Copyright (C) 2012 Ariya Hidayat <ariya.hidayat@gmail.com>\n  Copyright (C) 2012 Mathias Bynens <mathias@qiwi.be>\n  Copyright (C) 2012 Joost-Wim Boekesteijn <joost-wim@boekesteijn.nl>\n  Copyright (C) 2012 Kris Kowal <kris.kowal@cixar.com>\n  Copyright (C) 2012 Yusuke Suzuki <utatane.tea@gmail.com>\n  Copyright (C) 2012 Arpad Borsos <arpad.borsos@googlemail.com>\n  Copyright (C) 2011 Ariya Hidayat <ariya.hidayat@gmail.com>\n\n  Redistribution and use in source and binary forms, with or without\n  modification, are permitted provided that the following conditions are met:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n    * Redistributions in binary form must reproduce the above copyright\n      notice, this list of conditions and the following disclaimer in the\n      documentation and/or other materials provided with the distribution.\n\n  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n  ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY\n  DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF\n  THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n(function (global) {\n    'use strict';\n\n    var Token,\n        TokenName,\n        Syntax,\n        Messages,\n        source,\n        index,\n        length,\n        delegate,\n        lookahead,\n        state;\n\n    Token = {\n        BooleanLiteral: 1,\n        EOF: 2,\n        Identifier: 3,\n        Keyword: 4,\n        NullLiteral: 5,\n        NumericLiteral: 6,\n        Punctuator: 7,\n        StringLiteral: 8\n    };\n\n    TokenName = {};\n    TokenName[Token.BooleanLiteral] = 'Boolean';\n    TokenName[Token.EOF] = '<end>';\n    TokenName[Token.Identifier] = 'Identifier';\n    TokenName[Token.Keyword] = 'Keyword';\n    TokenName[Token.NullLiteral] = 'Null';\n    TokenName[Token.NumericLiteral] = 'Numeric';\n    TokenName[Token.Punctuator] = 'Punctuator';\n    TokenName[Token.StringLiteral] = 'String';\n\n    Syntax = {\n        ArrayExpression: 'ArrayExpression',\n        BinaryExpression: 'BinaryExpression',\n        CallExpression: 'CallExpression',\n        ConditionalExpression: 'ConditionalExpression',\n        EmptyStatement: 'EmptyStatement',\n        ExpressionStatement: 'ExpressionStatement',\n        Identifier: 'Identifier',\n        Literal: 'Literal',\n        LabeledStatement: 'LabeledStatement',\n        LogicalExpression: 'LogicalExpression',\n        MemberExpression: 'MemberExpression',\n        ObjectExpression: 'ObjectExpression',\n        Program: 'Program',\n        Property: 'Property',\n        ThisExpression: 'ThisExpression',\n        UnaryExpression: 'UnaryExpression'\n    };\n\n    // Error messages should be identical to V8.\n    Messages = {\n        UnexpectedToken:  'Unexpected token %0',\n        UnknownLabel: 'Undefined label \\'%0\\'',\n        Redeclaration: '%0 \\'%1\\' has already been declared'\n    };\n\n    // Ensure the condition is true, otherwise throw an error.\n    // This is only to have a better contract semantic, i.e. another safety net\n    // to catch a logic error. The condition shall be fulfilled in normal case.\n    // Do NOT use this to enforce a certain condition on any user input.\n\n    function assert(condition, message) {\n        if (!condition) {\n            throw new Error('ASSERT: ' + message);\n        }\n    }\n\n    function isDecimalDigit(ch) {\n        return (ch >= 48 && ch <= 57);   // 0..9\n    }\n\n\n    // 7.2 White Space\n\n    function isWhiteSpace(ch) {\n        return (ch === 32) ||  // space\n            (ch === 9) ||      // tab\n            (ch === 0xB) ||\n            (ch === 0xC) ||\n            (ch === 0xA0) ||\n            (ch >= 0x1680 && '\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\uFEFF'.indexOf(String.fromCharCode(ch)) > 0);\n    }\n\n    // 7.3 Line Terminators\n\n    function isLineTerminator(ch) {\n        return (ch === 10) || (ch === 13) || (ch === 0x2028) || (ch === 0x2029);\n    }\n\n    // 7.6 Identifier Names and Identifiers\n\n    function isIdentifierStart(ch) {\n        return (ch === 36) || (ch === 95) ||  // $ (dollar) and _ (underscore)\n            (ch >= 65 && ch <= 90) ||         // A..Z\n            (ch >= 97 && ch <= 122);          // a..z\n    }\n\n    function isIdentifierPart(ch) {\n        return (ch === 36) || (ch === 95) ||  // $ (dollar) and _ (underscore)\n            (ch >= 65 && ch <= 90) ||         // A..Z\n            (ch >= 97 && ch <= 122) ||        // a..z\n            (ch >= 48 && ch <= 57);           // 0..9\n    }\n\n    // 7.6.1.1 Keywords\n\n    function isKeyword(id) {\n        return (id === 'this')\n    }\n\n    // 7.4 Comments\n\n    function skipWhitespace() {\n        while (index < length && isWhiteSpace(source.charCodeAt(index))) {\n           ++index;\n        }\n    }\n\n    function getIdentifier() {\n        var start, ch;\n\n        start = index++;\n        while (index < length) {\n            ch = source.charCodeAt(index);\n            if (isIdentifierPart(ch)) {\n                ++index;\n            } else {\n                break;\n            }\n        }\n\n        return source.slice(start, index);\n    }\n\n    function scanIdentifier() {\n        var start, id, type;\n\n        start = index;\n\n        id = getIdentifier();\n\n        // There is no keyword or literal with only one character.\n        // Thus, it must be an identifier.\n        if (id.length === 1) {\n            type = Token.Identifier;\n        } else if (isKeyword(id)) {\n            type = Token.Keyword;\n        } else if (id === 'null') {\n            type = Token.NullLiteral;\n        } else if (id === 'true' || id === 'false') {\n            type = Token.BooleanLiteral;\n        } else {\n            type = Token.Identifier;\n        }\n\n        return {\n            type: type,\n            value: id,\n            range: [start, index]\n        };\n    }\n\n\n    // 7.7 Punctuators\n\n    function scanPunctuator() {\n        var start = index,\n            code = source.charCodeAt(index),\n            code2,\n            ch1 = source[index],\n            ch2;\n\n        switch (code) {\n\n        // Check for most common single-character punctuators.\n        case 46:   // . dot\n        case 40:   // ( open bracket\n        case 41:   // ) close bracket\n        case 59:   // ; semicolon\n        case 44:   // , comma\n        case 123:  // { open curly brace\n        case 125:  // } close curly brace\n        case 91:   // [\n        case 93:   // ]\n        case 58:   // :\n        case 63:   // ?\n            ++index;\n            return {\n                type: Token.Punctuator,\n                value: String.fromCharCode(code),\n                range: [start, index]\n            };\n\n        default:\n            code2 = source.charCodeAt(index + 1);\n\n            // '=' (char #61) marks an assignment or comparison operator.\n            if (code2 === 61) {\n                switch (code) {\n                case 37:  // %\n                case 38:  // &\n                case 42:  // *:\n                case 43:  // +\n                case 45:  // -\n                case 47:  // /\n                case 60:  // <\n                case 62:  // >\n                case 124: // |\n                    index += 2;\n                    return {\n                        type: Token.Punctuator,\n                        value: String.fromCharCode(code) + String.fromCharCode(code2),\n                        range: [start, index]\n                    };\n\n                case 33: // !\n                case 61: // =\n                    index += 2;\n\n                    // !== and ===\n                    if (source.charCodeAt(index) === 61) {\n                        ++index;\n                    }\n                    return {\n                        type: Token.Punctuator,\n                        value: source.slice(start, index),\n                        range: [start, index]\n                    };\n                default:\n                    break;\n                }\n            }\n            break;\n        }\n\n        // Peek more characters.\n\n        ch2 = source[index + 1];\n\n        // Other 2-character punctuators: && ||\n\n        if (ch1 === ch2 && ('&|'.indexOf(ch1) >= 0)) {\n            index += 2;\n            return {\n                type: Token.Punctuator,\n                value: ch1 + ch2,\n                range: [start, index]\n            };\n        }\n\n        if ('<>=!+-*%&|^/'.indexOf(ch1) >= 0) {\n            ++index;\n            return {\n                type: Token.Punctuator,\n                value: ch1,\n                range: [start, index]\n            };\n        }\n\n        throwError({}, Messages.UnexpectedToken, 'ILLEGAL');\n    }\n\n    // 7.8.3 Numeric Literals\n    function scanNumericLiteral() {\n        var number, start, ch;\n\n        ch = source[index];\n        assert(isDecimalDigit(ch.charCodeAt(0)) || (ch === '.'),\n            'Numeric literal must start with a decimal digit or a decimal point');\n\n        start = index;\n        number = '';\n        if (ch !== '.') {\n            number = source[index++];\n            ch = source[index];\n\n            // Hex number starts with '0x'.\n            // Octal number starts with '0'.\n            if (number === '0') {\n                // decimal number starts with '0' such as '09' is illegal.\n                if (ch && isDecimalDigit(ch.charCodeAt(0))) {\n                    throwError({}, Messages.UnexpectedToken, 'ILLEGAL');\n                }\n            }\n\n            while (isDecimalDigit(source.charCodeAt(index))) {\n                number += source[index++];\n            }\n            ch = source[index];\n        }\n\n        if (ch === '.') {\n            number += source[index++];\n            while (isDecimalDigit(source.charCodeAt(index))) {\n                number += source[index++];\n            }\n            ch = source[index];\n        }\n\n        if (ch === 'e' || ch === 'E') {\n            number += source[index++];\n\n            ch = source[index];\n            if (ch === '+' || ch === '-') {\n                number += source[index++];\n            }\n            if (isDecimalDigit(source.charCodeAt(index))) {\n                while (isDecimalDigit(source.charCodeAt(index))) {\n                    number += source[index++];\n                }\n            } else {\n                throwError({}, Messages.UnexpectedToken, 'ILLEGAL');\n            }\n        }\n\n        if (isIdentifierStart(source.charCodeAt(index))) {\n            throwError({}, Messages.UnexpectedToken, 'ILLEGAL');\n        }\n\n        return {\n            type: Token.NumericLiteral,\n            value: parseFloat(number),\n            range: [start, index]\n        };\n    }\n\n    // 7.8.4 String Literals\n\n    function scanStringLiteral() {\n        var str = '', quote, start, ch, octal = false;\n\n        quote = source[index];\n        assert((quote === '\\'' || quote === '\"'),\n            'String literal must starts with a quote');\n\n        start = index;\n        ++index;\n\n        while (index < length) {\n            ch = source[index++];\n\n            if (ch === quote) {\n                quote = '';\n                break;\n            } else if (ch === '\\\\') {\n                ch = source[index++];\n                if (!ch || !isLineTerminator(ch.charCodeAt(0))) {\n                    switch (ch) {\n                    case 'n':\n                        str += '\\n';\n                        break;\n                    case 'r':\n                        str += '\\r';\n                        break;\n                    case 't':\n                        str += '\\t';\n                        break;\n                    case 'b':\n                        str += '\\b';\n                        break;\n                    case 'f':\n                        str += '\\f';\n                        break;\n                    case 'v':\n                        str += '\\x0B';\n                        break;\n\n                    default:\n                        str += ch;\n                        break;\n                    }\n                } else {\n                    if (ch ===  '\\r' && source[index] === '\\n') {\n                        ++index;\n                    }\n                }\n            } else if (isLineTerminator(ch.charCodeAt(0))) {\n                break;\n            } else {\n                str += ch;\n            }\n        }\n\n        if (quote !== '') {\n            throwError({}, Messages.UnexpectedToken, 'ILLEGAL');\n        }\n\n        return {\n            type: Token.StringLiteral,\n            value: str,\n            octal: octal,\n            range: [start, index]\n        };\n    }\n\n    function isIdentifierName(token) {\n        return token.type === Token.Identifier ||\n            token.type === Token.Keyword ||\n            token.type === Token.BooleanLiteral ||\n            token.type === Token.NullLiteral;\n    }\n\n    function advance() {\n        var ch;\n\n        skipWhitespace();\n\n        if (index >= length) {\n            return {\n                type: Token.EOF,\n                range: [index, index]\n            };\n        }\n\n        ch = source.charCodeAt(index);\n\n        // Very common: ( and ) and ;\n        if (ch === 40 || ch === 41 || ch === 58) {\n            return scanPunctuator();\n        }\n\n        // String literal starts with single quote (#39) or double quote (#34).\n        if (ch === 39 || ch === 34) {\n            return scanStringLiteral();\n        }\n\n        if (isIdentifierStart(ch)) {\n            return scanIdentifier();\n        }\n\n        // Dot (.) char #46 can also start a floating-point number, hence the need\n        // to check the next character.\n        if (ch === 46) {\n            if (isDecimalDigit(source.charCodeAt(index + 1))) {\n                return scanNumericLiteral();\n            }\n            return scanPunctuator();\n        }\n\n        if (isDecimalDigit(ch)) {\n            return scanNumericLiteral();\n        }\n\n        return scanPunctuator();\n    }\n\n    function lex() {\n        var token;\n\n        token = lookahead;\n        index = token.range[1];\n\n        lookahead = advance();\n\n        index = token.range[1];\n\n        return token;\n    }\n\n    function peek() {\n        var pos;\n\n        pos = index;\n        lookahead = advance();\n        index = pos;\n    }\n\n    // Throw an exception\n\n    function throwError(token, messageFormat) {\n        var error,\n            args = Array.prototype.slice.call(arguments, 2),\n            msg = messageFormat.replace(\n                /%(\\d)/g,\n                function (whole, index) {\n                    assert(index < args.length, 'Message reference must be in range');\n                    return args[index];\n                }\n            );\n\n        error = new Error(msg);\n        error.index = index;\n        error.description = msg;\n        throw error;\n    }\n\n    // Throw an exception because of the token.\n\n    function throwUnexpected(token) {\n        throwError(token, Messages.UnexpectedToken, token.value);\n    }\n\n    // Expect the next token to match the specified punctuator.\n    // If not, an exception will be thrown.\n\n    function expect(value) {\n        var token = lex();\n        if (token.type !== Token.Punctuator || token.value !== value) {\n            throwUnexpected(token);\n        }\n    }\n\n    // Return true if the next token matches the specified punctuator.\n\n    function match(value) {\n        return lookahead.type === Token.Punctuator && lookahead.value === value;\n    }\n\n    // Return true if the next token matches the specified keyword\n\n    function matchKeyword(keyword) {\n        return lookahead.type === Token.Keyword && lookahead.value === keyword;\n    }\n\n    function consumeSemicolon() {\n        // Catch the very common case first: immediately a semicolon (char #59).\n        if (source.charCodeAt(index) === 59) {\n            lex();\n            return;\n        }\n\n        skipWhitespace();\n\n        if (match(';')) {\n            lex();\n            return;\n        }\n\n        if (lookahead.type !== Token.EOF && !match('}')) {\n            throwUnexpected(lookahead);\n        }\n    }\n\n    // 11.1.4 Array Initialiser\n\n    function parseArrayInitialiser() {\n        var elements = [];\n\n        expect('[');\n\n        while (!match(']')) {\n            if (match(',')) {\n                lex();\n                elements.push(null);\n            } else {\n                elements.push(parseExpression());\n\n                if (!match(']')) {\n                    expect(',');\n                }\n            }\n        }\n\n        expect(']');\n\n        return delegate.createArrayExpression(elements);\n    }\n\n    // 11.1.5 Object Initialiser\n\n    function parseObjectPropertyKey() {\n        var token;\n\n        skipWhitespace();\n        token = lex();\n\n        // Note: This function is called only from parseObjectProperty(), where\n        // EOF and Punctuator tokens are already filtered out.\n        if (token.type === Token.StringLiteral || token.type === Token.NumericLiteral) {\n            return delegate.createLiteral(token);\n        }\n\n        return delegate.createIdentifier(token.value);\n    }\n\n    function parseObjectProperty() {\n        var token, key;\n\n        token = lookahead;\n        skipWhitespace();\n\n        if (token.type === Token.EOF || token.type === Token.Punctuator) {\n            throwUnexpected(token);\n        }\n\n        key = parseObjectPropertyKey();\n        expect(':');\n        return delegate.createProperty('init', key, parseExpression());\n    }\n\n    function parseObjectInitialiser() {\n        var properties = [];\n\n        expect('{');\n\n        while (!match('}')) {\n            properties.push(parseObjectProperty());\n\n            if (!match('}')) {\n                expect(',');\n            }\n        }\n\n        expect('}');\n\n        return delegate.createObjectExpression(properties);\n    }\n\n    // 11.1.6 The Grouping Operator\n\n    function parseGroupExpression() {\n        var expr;\n\n        expect('(');\n\n        expr = parseExpression();\n\n        expect(')');\n\n        return expr;\n    }\n\n\n    // 11.1 Primary Expressions\n\n    function parsePrimaryExpression() {\n        var type, token, expr;\n\n        if (match('(')) {\n            return parseGroupExpression();\n        }\n\n        type = lookahead.type;\n\n        if (type === Token.Identifier) {\n            expr = delegate.createIdentifier(lex().value);\n        } else if (type === Token.StringLiteral || type === Token.NumericLiteral) {\n            expr = delegate.createLiteral(lex());\n        } else if (type === Token.Keyword) {\n            if (matchKeyword('this')) {\n                lex();\n                expr = delegate.createThisExpression();\n            }\n        } else if (type === Token.BooleanLiteral) {\n            token = lex();\n            token.value = (token.value === 'true');\n            expr = delegate.createLiteral(token);\n        } else if (type === Token.NullLiteral) {\n            token = lex();\n            token.value = null;\n            expr = delegate.createLiteral(token);\n        } else if (match('[')) {\n            expr = parseArrayInitialiser();\n        } else if (match('{')) {\n            expr = parseObjectInitialiser();\n        }\n\n        if (expr) {\n            return expr;\n        }\n\n        throwUnexpected(lex());\n    }\n\n    // 11.2 Left-Hand-Side Expressions\n\n    function parseArguments() {\n        var args = [];\n\n        expect('(');\n\n        if (!match(')')) {\n            while (index < length) {\n                args.push(parseExpression());\n                if (match(')')) {\n                    break;\n                }\n                expect(',');\n            }\n        }\n\n        expect(')');\n\n        return args;\n    }\n\n    function parseNonComputedProperty() {\n        var token;\n\n        token = lex();\n\n        if (!isIdentifierName(token)) {\n            throwUnexpected(token);\n        }\n\n        return delegate.createIdentifier(token.value);\n    }\n\n    function parseNonComputedMember() {\n        expect('.');\n\n        return parseNonComputedProperty();\n    }\n\n    function parseComputedMember() {\n        var expr;\n\n        expect('[');\n\n        expr = parseExpression();\n\n        expect(']');\n\n        return expr;\n    }\n\n    function parseLeftHandSideExpression() {\n        var expr, property;\n\n        expr = parsePrimaryExpression();\n\n        while (match('.') || match('[')) {\n            if (match('[')) {\n                property = parseComputedMember();\n                expr = delegate.createMemberExpression('[', expr, property);\n            } else {\n                property = parseNonComputedMember();\n                expr = delegate.createMemberExpression('.', expr, property);\n            }\n        }\n\n        return expr;\n    }\n\n    // 11.3 Postfix Expressions\n\n    var parsePostfixExpression = parseLeftHandSideExpression;\n\n    // 11.4 Unary Operators\n\n    function parseUnaryExpression() {\n        var token, expr;\n\n        if (lookahead.type !== Token.Punctuator && lookahead.type !== Token.Keyword) {\n            expr = parsePostfixExpression();\n        } else if (match('+') || match('-') || match('!')) {\n            token = lex();\n            expr = parseUnaryExpression();\n            expr = delegate.createUnaryExpression(token.value, expr);\n        } else if (matchKeyword('delete') || matchKeyword('void') || matchKeyword('typeof')) {\n            throwError({}, Messages.UnexpectedToken);\n        } else {\n            expr = parsePostfixExpression();\n        }\n\n        return expr;\n    }\n\n    function binaryPrecedence(token) {\n        var prec = 0;\n\n        if (token.type !== Token.Punctuator && token.type !== Token.Keyword) {\n            return 0;\n        }\n\n        switch (token.value) {\n        case '||':\n            prec = 1;\n            break;\n\n        case '&&':\n            prec = 2;\n            break;\n\n        case '==':\n        case '!=':\n        case '===':\n        case '!==':\n            prec = 6;\n            break;\n\n        case '<':\n        case '>':\n        case '<=':\n        case '>=':\n        case 'instanceof':\n            prec = 7;\n            break;\n\n        case 'in':\n            prec = 7;\n            break;\n\n        case '+':\n        case '-':\n            prec = 9;\n            break;\n\n        case '*':\n        case '/':\n        case '%':\n            prec = 11;\n            break;\n\n        default:\n            break;\n        }\n\n        return prec;\n    }\n\n    // 11.5 Multiplicative Operators\n    // 11.6 Additive Operators\n    // 11.7 Bitwise Shift Operators\n    // 11.8 Relational Operators\n    // 11.9 Equality Operators\n    // 11.10 Binary Bitwise Operators\n    // 11.11 Binary Logical Operators\n\n    function parseBinaryExpression() {\n        var expr, token, prec, stack, right, operator, left, i;\n\n        left = parseUnaryExpression();\n\n        token = lookahead;\n        prec = binaryPrecedence(token);\n        if (prec === 0) {\n            return left;\n        }\n        token.prec = prec;\n        lex();\n\n        right = parseUnaryExpression();\n\n        stack = [left, token, right];\n\n        while ((prec = binaryPrecedence(lookahead)) > 0) {\n\n            // Reduce: make a binary expression from the three topmost entries.\n            while ((stack.length > 2) && (prec <= stack[stack.length - 2].prec)) {\n                right = stack.pop();\n                operator = stack.pop().value;\n                left = stack.pop();\n                expr = delegate.createBinaryExpression(operator, left, right);\n                stack.push(expr);\n            }\n\n            // Shift.\n            token = lex();\n            token.prec = prec;\n            stack.push(token);\n            expr = parseUnaryExpression();\n            stack.push(expr);\n        }\n\n        // Final reduce to clean-up the stack.\n        i = stack.length - 1;\n        expr = stack[i];\n        while (i > 1) {\n            expr = delegate.createBinaryExpression(stack[i - 1].value, stack[i - 2], expr);\n            i -= 2;\n        }\n\n        return expr;\n    }\n\n\n    // 11.12 Conditional Operator\n\n    function parseConditionalExpression() {\n        var expr, consequent, alternate;\n\n        expr = parseBinaryExpression();\n\n        if (match('?')) {\n            lex();\n            consequent = parseConditionalExpression();\n            expect(':');\n            alternate = parseConditionalExpression();\n\n            expr = delegate.createConditionalExpression(expr, consequent, alternate);\n        }\n\n        return expr;\n    }\n\n    // Simplification since we do not support AssignmentExpression.\n    var parseExpression = parseConditionalExpression;\n\n    // Polymer Syntax extensions\n\n    // Filter ::\n    //   Identifier\n    //   Identifier \"(\" \")\"\n    //   Identifier \"(\" FilterArguments \")\"\n\n    function parseFilter() {\n        var identifier, args;\n\n        identifier = lex();\n\n        if (identifier.type !== Token.Identifier) {\n            throwUnexpected(identifier);\n        }\n\n        args = match('(') ? parseArguments() : [];\n\n        return delegate.createFilter(identifier.value, args);\n    }\n\n    // Filters ::\n    //   \"|\" Filter\n    //   Filters \"|\" Filter\n\n    function parseFilters() {\n        while (match('|')) {\n            lex();\n            parseFilter();\n        }\n    }\n\n    // TopLevel ::\n    //   LabelledExpressions\n    //   AsExpression\n    //   InExpression\n    //   FilterExpression\n\n    // AsExpression ::\n    //   FilterExpression as Identifier\n\n    // InExpression ::\n    //   Identifier, Identifier in FilterExpression\n    //   Identifier in FilterExpression\n\n    // FilterExpression ::\n    //   Expression\n    //   Expression Filters\n\n    function parseTopLevel() {\n        skipWhitespace();\n        peek();\n\n        var expr = parseExpression();\n        if (expr) {\n            if (lookahead.value === ',' || lookahead.value == 'in' &&\n                       expr.type === Syntax.Identifier) {\n                parseInExpression(expr);\n            } else {\n                parseFilters();\n                if (lookahead.value === 'as') {\n                    parseAsExpression(expr);\n                } else {\n                    delegate.createTopLevel(expr);\n                }\n            }\n        }\n\n        if (lookahead.type !== Token.EOF) {\n            throwUnexpected(lookahead);\n        }\n    }\n\n    function parseAsExpression(expr) {\n        lex();  // as\n        var identifier = lex().value;\n        delegate.createAsExpression(expr, identifier);\n    }\n\n    function parseInExpression(identifier) {\n        var indexName;\n        if (lookahead.value === ',') {\n            lex();\n            if (lookahead.type !== Token.Identifier)\n                throwUnexpected(lookahead);\n            indexName = lex().value;\n        }\n\n        lex();  // in\n        var expr = parseExpression();\n        parseFilters();\n        delegate.createInExpression(identifier.name, indexName, expr);\n    }\n\n    function parse(code, inDelegate) {\n        delegate = inDelegate;\n        source = code;\n        index = 0;\n        length = source.length;\n        lookahead = null;\n        state = {\n            labelSet: {}\n        };\n\n        return parseTopLevel();\n    }\n\n    global.esprima = {\n        parse: parse\n    };\n})(this);\n","// Copyright (c) 2014 The Polymer Project Authors. All rights reserved.\n// This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\n// The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\n// The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\n// Code distributed by Google as part of the polymer project is also\n// subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n\n(function (global) {\n  'use strict';\n\n  // JScript does not have __proto__. We wrap all object literals with\n  // createObject which uses Object.create, Object.defineProperty and\n  // Object.getOwnPropertyDescriptor to create a new object that does the exact\n  // same thing. The main downside to this solution is that we have to extract\n  // all those property descriptors for IE.\n  var createObject = ('__proto__' in {}) ?\n      function(obj) { return obj; } :\n      function(obj) {\n        var proto = obj.__proto__;\n        if (!proto)\n          return obj;\n        var newObject = Object.create(proto);\n        Object.getOwnPropertyNames(obj).forEach(function(name) {\n          Object.defineProperty(newObject, name,\n                               Object.getOwnPropertyDescriptor(obj, name));\n        });\n        return newObject;\n      };\n\n  function prepareBinding(expressionText, name, node, filterRegistry) {\n    var expression;\n    try {\n      expression = getExpression(expressionText);\n      if (expression.scopeIdent &&\n          (node.nodeType !== Node.ELEMENT_NODE ||\n           node.tagName !== 'TEMPLATE' ||\n           (name !== 'bind' && name !== 'repeat'))) {\n        throw Error('as and in can only be used within <template bind/repeat>');\n      }\n    } catch (ex) {\n      console.error('Invalid expression syntax: ' + expressionText, ex);\n      return;\n    }\n\n    return function(model, node, oneTime) {\n      var binding = expression.getBinding(model, filterRegistry, oneTime);\n      if (expression.scopeIdent && binding) {\n        node.polymerExpressionScopeIdent_ = expression.scopeIdent;\n        if (expression.indexIdent)\n          node.polymerExpressionIndexIdent_ = expression.indexIdent;\n      }\n\n      return binding;\n    }\n  }\n\n  // TODO(rafaelw): Implement simple LRU.\n  var expressionParseCache = Object.create(null);\n\n  function getExpression(expressionText) {\n    var expression = expressionParseCache[expressionText];\n    if (!expression) {\n      var delegate = new ASTDelegate();\n      esprima.parse(expressionText, delegate);\n      expression = new Expression(delegate);\n      expressionParseCache[expressionText] = expression;\n    }\n    return expression;\n  }\n\n  function Literal(value) {\n    this.value = value;\n    this.valueFn_ = undefined;\n  }\n\n  Literal.prototype = {\n    valueFn: function() {\n      if (!this.valueFn_) {\n        var value = this.value;\n        this.valueFn_ = function() {\n          return value;\n        }\n      }\n\n      return this.valueFn_;\n    }\n  }\n\n  function IdentPath(name) {\n    this.name = name;\n    this.path = Path.get(name);\n  }\n\n  IdentPath.prototype = {\n    valueFn: function() {\n      if (!this.valueFn_) {\n        var name = this.name;\n        var path = this.path;\n        this.valueFn_ = function(model, observer) {\n          if (observer)\n            observer.addPath(model, path);\n\n          return path.getValueFrom(model);\n        }\n      }\n\n      return this.valueFn_;\n    },\n\n    setValue: function(model, newValue) {\n      if (this.path.length == 1);\n        model = findScope(model, this.path[0]);\n\n      return this.path.setValueFrom(model, newValue);\n    }\n  };\n\n  function MemberExpression(object, property, accessor) {\n    // convert literal computed property access where literal value is a value\n    // path to ident dot-access.\n    if (accessor == '[' &&\n        property instanceof Literal &&\n        Path.get(property.value).valid) {\n      accessor = '.';\n      property = new IdentPath(property.value);\n    }\n\n    this.dynamicDeps = typeof object == 'function' || object.dynamic;\n\n    this.dynamic = typeof property == 'function' ||\n                   property.dynamic ||\n                   accessor == '[';\n\n    this.simplePath =\n        !this.dynamic &&\n        !this.dynamicDeps &&\n        property instanceof IdentPath &&\n        (object instanceof MemberExpression || object instanceof IdentPath);\n\n    this.object = this.simplePath ? object : getFn(object);\n    this.property = accessor == '.' ? property : getFn(property);\n  }\n\n  MemberExpression.prototype = {\n    get fullPath() {\n      if (!this.fullPath_) {\n        var last = this.object instanceof IdentPath ?\n            this.object.name : this.object.fullPath;\n        this.fullPath_ = Path.get(last + '.' + this.property.name);\n      }\n\n      return this.fullPath_;\n    },\n\n    valueFn: function() {\n      if (!this.valueFn_) {\n        var object = this.object;\n\n        if (this.simplePath) {\n          var path = this.fullPath;\n\n          this.valueFn_ = function(model, observer) {\n            if (observer)\n              observer.addPath(model, path);\n\n            return path.getValueFrom(model);\n          };\n        } else if (this.property instanceof IdentPath) {\n          var path = Path.get(this.property.name);\n\n          this.valueFn_ = function(model, observer) {\n            var context = object(model, observer);\n\n            if (observer)\n              observer.addPath(context, path);\n\n            return path.getValueFrom(context);\n          }\n        } else {\n          // Computed property.\n          var property = this.property;\n\n          this.valueFn_ = function(model, observer) {\n            var context = object(model, observer);\n            var propName = property(model, observer);\n            if (observer)\n              observer.addPath(context, propName);\n\n            return context ? context[propName] : undefined;\n          };\n        }\n      }\n      return this.valueFn_;\n    },\n\n    setValue: function(model, newValue) {\n      if (this.simplePath) {\n        this.fullPath.setValueFrom(model, newValue);\n        return newValue;\n      }\n\n      var object = this.object(model);\n      var propName = this.property instanceof IdentPath ? this.property.name :\n          this.property(model);\n      return object[propName] = newValue;\n    }\n  };\n\n  function Filter(name, args) {\n    this.name = name;\n    this.args = [];\n    for (var i = 0; i < args.length; i++) {\n      this.args[i] = getFn(args[i]);\n    }\n  }\n\n  Filter.prototype = {\n    transform: function(value, toModelDirection, filterRegistry, model,\n                        observer) {\n      var fn = filterRegistry[this.name];\n      var context = model;\n      if (fn) {\n        context = undefined;\n      } else {\n        fn = context[this.name];\n        if (!fn) {\n          console.error('Cannot find filter: ' + this.name);\n          return;\n        }\n      }\n\n      // If toModelDirection is falsey, then the \"normal\" (dom-bound) direction\n      // is used. Otherwise, it looks for a 'toModel' property function on the\n      // object.\n      if (toModelDirection) {\n        fn = fn.toModel;\n      } else if (typeof fn.toDOM == 'function') {\n        fn = fn.toDOM;\n      }\n\n      if (typeof fn != 'function') {\n        console.error('No ' + (toModelDirection ? 'toModel' : 'toDOM') +\n                      ' found on' + this.name);\n        return;\n      }\n\n      var args = [value];\n      for (var i = 0; i < this.args.length; i++) {\n        args[i + 1] = getFn(this.args[i])(model, observer);\n      }\n\n      return fn.apply(context, args);\n    }\n  };\n\n  function notImplemented() { throw Error('Not Implemented'); }\n\n  var unaryOperators = {\n    '+': function(v) { return +v; },\n    '-': function(v) { return -v; },\n    '!': function(v) { return !v; }\n  };\n\n  var binaryOperators = {\n    '+': function(l, r) { return l+r; },\n    '-': function(l, r) { return l-r; },\n    '*': function(l, r) { return l*r; },\n    '/': function(l, r) { return l/r; },\n    '%': function(l, r) { return l%r; },\n    '<': function(l, r) { return l<r; },\n    '>': function(l, r) { return l>r; },\n    '<=': function(l, r) { return l<=r; },\n    '>=': function(l, r) { return l>=r; },\n    '==': function(l, r) { return l==r; },\n    '!=': function(l, r) { return l!=r; },\n    '===': function(l, r) { return l===r; },\n    '!==': function(l, r) { return l!==r; },\n    '&&': function(l, r) { return l&&r; },\n    '||': function(l, r) { return l||r; },\n  };\n\n  function getFn(arg) {\n    return typeof arg == 'function' ? arg : arg.valueFn();\n  }\n\n  function ASTDelegate() {\n    this.expression = null;\n    this.filters = [];\n    this.deps = {};\n    this.currentPath = undefined;\n    this.scopeIdent = undefined;\n    this.indexIdent = undefined;\n    this.dynamicDeps = false;\n  }\n\n  ASTDelegate.prototype = {\n    createUnaryExpression: function(op, argument) {\n      if (!unaryOperators[op])\n        throw Error('Disallowed operator: ' + op);\n\n      argument = getFn(argument);\n\n      return function(model, observer) {\n        return unaryOperators[op](argument(model, observer));\n      };\n    },\n\n    createBinaryExpression: function(op, left, right) {\n      if (!binaryOperators[op])\n        throw Error('Disallowed operator: ' + op);\n\n      left = getFn(left);\n      right = getFn(right);\n\n      return function(model, observer) {\n        return binaryOperators[op](left(model, observer),\n                                   right(model, observer));\n      };\n    },\n\n    createConditionalExpression: function(test, consequent, alternate) {\n      test = getFn(test);\n      consequent = getFn(consequent);\n      alternate = getFn(alternate);\n\n      return function(model, observer) {\n        return test(model, observer) ?\n            consequent(model, observer) : alternate(model, observer);\n      }\n    },\n\n    createIdentifier: function(name) {\n      var ident = new IdentPath(name);\n      ident.type = 'Identifier';\n      return ident;\n    },\n\n    createMemberExpression: function(accessor, object, property) {\n      var ex = new MemberExpression(object, property, accessor);\n      if (ex.dynamicDeps)\n        this.dynamicDeps = true;\n      return ex;\n    },\n\n    createLiteral: function(token) {\n      return new Literal(token.value);\n    },\n\n    createArrayExpression: function(elements) {\n      for (var i = 0; i < elements.length; i++)\n        elements[i] = getFn(elements[i]);\n\n      return function(model, observer) {\n        var arr = []\n        for (var i = 0; i < elements.length; i++)\n          arr.push(elements[i](model, observer));\n        return arr;\n      }\n    },\n\n    createProperty: function(kind, key, value) {\n      return {\n        key: key instanceof IdentPath ? key.name : key.value,\n        value: value\n      };\n    },\n\n    createObjectExpression: function(properties) {\n      for (var i = 0; i < properties.length; i++)\n        properties[i].value = getFn(properties[i].value);\n\n      return function(model, observer) {\n        var obj = {};\n        for (var i = 0; i < properties.length; i++)\n          obj[properties[i].key] = properties[i].value(model, observer);\n        return obj;\n      }\n    },\n\n    createFilter: function(name, args) {\n      this.filters.push(new Filter(name, args));\n    },\n\n    createAsExpression: function(expression, scopeIdent) {\n      this.expression = expression;\n      this.scopeIdent = scopeIdent;\n    },\n\n    createInExpression: function(scopeIdent, indexIdent, expression) {\n      this.expression = expression;\n      this.scopeIdent = scopeIdent;\n      this.indexIdent = indexIdent;\n    },\n\n    createTopLevel: function(expression) {\n      this.expression = expression;\n    },\n\n    createThisExpression: notImplemented\n  }\n\n  function ConstantObservable(value) {\n    this.value_ = value;\n  }\n\n  ConstantObservable.prototype = {\n    open: function() { return this.value_; },\n    discardChanges: function() { return this.value_; },\n    deliver: function() {},\n    close: function() {},\n  }\n\n  function Expression(delegate) {\n    this.scopeIdent = delegate.scopeIdent;\n    this.indexIdent = delegate.indexIdent;\n\n    if (!delegate.expression)\n      throw Error('No expression found.');\n\n    this.expression = delegate.expression;\n    getFn(this.expression); // forces enumeration of path dependencies\n\n    this.filters = delegate.filters;\n    this.dynamicDeps = delegate.dynamicDeps;\n  }\n\n  Expression.prototype = {\n    getBinding: function(model, filterRegistry, oneTime) {\n      if (oneTime)\n        return this.getValue(model, undefined, filterRegistry);\n\n      var observer = new CompoundObserver();\n      // captures deps.\n      var firstValue = this.getValue(model, observer, filterRegistry);\n      var firstTime = true;\n      var self = this;\n\n      function valueFn() {\n        // deps cannot have changed on first value retrieval.\n        if (firstTime) {\n          firstTime = false;\n          return firstValue;\n        }\n\n        if (self.dynamicDeps)\n          observer.startReset();\n\n        var value = self.getValue(model,\n                                  self.dynamicDeps ? observer : undefined,\n                                  filterRegistry);\n        if (self.dynamicDeps)\n          observer.finishReset();\n\n        return value;\n      }\n\n      function setValueFn(newValue) {\n        self.setValue(model, newValue, filterRegistry);\n        return newValue;\n      }\n\n      return new ObserverTransform(observer, valueFn, setValueFn, true);\n    },\n\n    getValue: function(model, observer, filterRegistry) {\n      var value = getFn(this.expression)(model, observer);\n      for (var i = 0; i < this.filters.length; i++) {\n        value = this.filters[i].transform(value, false, filterRegistry, model,\n                                          observer);\n      }\n\n      return value;\n    },\n\n    setValue: function(model, newValue, filterRegistry) {\n      var count = this.filters ? this.filters.length : 0;\n      while (count-- > 0) {\n        newValue = this.filters[count].transform(newValue, true, filterRegistry,\n                                                 model);\n      }\n\n      if (this.expression.setValue)\n        return this.expression.setValue(model, newValue);\n    }\n  }\n\n  /**\n   * Converts a style property name to a css property name. For example:\n   * \"WebkitUserSelect\" to \"-webkit-user-select\"\n   */\n  function convertStylePropertyName(name) {\n    return String(name).replace(/[A-Z]/g, function(c) {\n      return '-' + c.toLowerCase();\n    });\n  }\n\n  var parentScopeName = '@' + Math.random().toString(36).slice(2);\n\n  // Single ident paths must bind directly to the appropriate scope object.\n  // I.e. Pushed values in two-bindings need to be assigned to the actual model\n  // object.\n  function findScope(model, prop) {\n    while (model[parentScopeName] &&\n           !Object.prototype.hasOwnProperty.call(model, prop)) {\n      model = model[parentScopeName];\n    }\n\n    return model;\n  }\n\n  function isLiteralExpression(pathString) {\n    switch (pathString) {\n      case '':\n        return false;\n\n      case 'false':\n      case 'null':\n      case 'true':\n        return true;\n    }\n\n    if (!isNaN(Number(pathString)))\n      return true;\n\n    return false;\n  };\n\n  function PolymerExpressions() {}\n\n  PolymerExpressions.prototype = {\n    // \"built-in\" filters\n    styleObject: function(value) {\n      var parts = [];\n      for (var key in value) {\n        parts.push(convertStylePropertyName(key) + ': ' + value[key]);\n      }\n      return parts.join('; ');\n    },\n\n    tokenList: function(value) {\n      var tokens = [];\n      for (var key in value) {\n        if (value[key])\n          tokens.push(key);\n      }\n      return tokens.join(' ');\n    },\n\n    // binding delegate API\n    prepareInstancePositionChanged: function(template) {\n      var indexIdent = template.polymerExpressionIndexIdent_;\n      if (!indexIdent)\n        return;\n\n      return function(templateInstance, index) {\n        templateInstance.model[indexIdent] = index;\n      };\n    },\n\n    prepareBinding: function(pathString, name, node) {\n      var path = Path.get(pathString);\n\n      if (!isLiteralExpression(pathString) && path.valid) {\n        if (path.length == 1) {\n          return function(model, node, oneTime) {\n            if (oneTime)\n              return path.getValueFrom(model);\n\n            var scope = findScope(model, path[0]);\n            return new PathObserver(scope, path);\n          };\n        }\n        return; // bail out early if pathString is simple path.\n      }\n\n      return prepareBinding(pathString, name, node, this);\n    },\n\n    prepareInstanceModel: function(template) {\n      var scopeName = template.polymerExpressionScopeIdent_;\n      if (!scopeName)\n        return;\n\n      var parentScope = template.templateInstance ?\n          template.templateInstance.model :\n          template.model;\n\n      var indexName = template.polymerExpressionIndexIdent_;\n\n      return function(model) {\n        var scope = Object.create(parentScope);\n        scope[scopeName] = model;\n        scope[indexName] = undefined;\n        scope[parentScopeName] = parentScope;\n        return scope;\n      };\n    }\n  };\n\n  global.PolymerExpressions = PolymerExpressions;\n  if (global.exposeGetExpression)\n    global.getExpression_ = getExpression;\n\n})(this);\n","/*\n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\nPolymer = {};\n","/*\n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\n\n// TODO(sorvell): this ensures Polymer is an object and not a function\n// Platform is currently defining it as a function to allow for async loading\n// of polymer; once we refine the loading process this likely goes away.\nif (typeof window.Polymer === 'function') {\n  Polymer = {};\n}\n\n","/*\n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\n(function(scope) {\n\n  // copy own properties from 'api' to 'prototype, with name hinting for 'super'\n  function extend(prototype, api) {\n    if (prototype && api) {\n      // use only own properties of 'api'\n      Object.getOwnPropertyNames(api).forEach(function(n) {\n        // acquire property descriptor\n        var pd = Object.getOwnPropertyDescriptor(api, n);\n        if (pd) {\n          // clone property via descriptor\n          Object.defineProperty(prototype, n, pd);\n          // cache name-of-method for 'super' engine\n          if (typeof pd.value == 'function') {\n            // hint the 'super' engine\n            pd.value.nom = n;\n          }\n        }\n      });\n    }\n    return prototype;\n  }\n  \n  // exports\n\n  scope.extend = extend;\n\n})(Polymer);\n","/* \n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\n\n(function(scope) {\n  \n  // usage\n  \n  // invoke cb.call(this) in 100ms, unless the job is re-registered,\n  // which resets the timer\n  // \n  // this.myJob = this.job(this.myJob, cb, 100)\n  //\n  // returns a job handle which can be used to re-register a job\n\n  var Job = function(inContext) {\n    this.context = inContext;\n    this.boundComplete = this.complete.bind(this)\n  };\n  Job.prototype = {\n    go: function(callback, wait) {\n      this.callback = callback;\n      var h;\n      if (!wait) {\n        h = requestAnimationFrame(this.boundComplete);\n        this.handle = function() {\n          cancelAnimationFrame(h);\n        }\n      } else {\n        h = setTimeout(this.boundComplete, wait);\n        this.handle = function() {\n          clearTimeout(h);\n        }\n      }\n    },\n    stop: function() {\n      if (this.handle) {\n        this.handle();\n        this.handle = null;\n      }\n    },\n    complete: function() {\n      if (this.handle) {\n        this.stop();\n        this.callback.call(this.context);\n      }\n    }\n  };\n  \n  function job(job, callback, wait) {\n    if (job) {\n      job.stop();\n    } else {\n      job = new Job(this);\n    }\n    job.go(callback, wait);\n    return job;\n  }\n  \n  // exports \n\n  scope.job = job;\n  \n})(Polymer);\n","/*\n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\n(function(scope) {\n\n  var registry = {};\n\n  HTMLElement.register = function(tag, prototype) {\n    registry[tag] = prototype;\n  }\n\n  // get prototype mapped to node <tag>\n  HTMLElement.getPrototypeForTag = function(tag) {\n    var prototype = !tag ? HTMLElement.prototype : registry[tag];\n    // TODO(sjmiles): creating <tag> is likely to have wasteful side-effects\n    return prototype || Object.getPrototypeOf(document.createElement(tag));\n  };\n\n  // we have to flag propagation stoppage for the event dispatcher\n  var originalStopPropagation = Event.prototype.stopPropagation;\n  Event.prototype.stopPropagation = function() {\n    this.cancelBubble = true;\n    originalStopPropagation.apply(this, arguments);\n  };\n  \n  // TODO(sorvell): remove when we're sure imports does not need\n  // to load stylesheets\n  /*\n  HTMLImports.importer.preloadSelectors += \n      ', polymer-element link[rel=stylesheet]';\n  */\n})(Polymer);\n","/*\r\n * Copyright 2013 The Polymer Authors. All rights reserved.\r\n * Use of this source code is governed by a BSD-style\r\n * license that can be found in the LICENSE file.\r\n */\r\n (function(scope) {\r\n    // super\r\n\r\n    // `arrayOfArgs` is an optional array of args like one might pass\r\n    // to `Function.apply`\r\n\r\n    // TODO(sjmiles):\r\n    //    $super must be installed on an instance or prototype chain\r\n    //    as `super`, and invoked via `this`, e.g.\r\n    //      `this.super();`\r\n\r\n    //    will not work if function objects are not unique, for example,\r\n    //    when using mixins.\r\n    //    The memoization strategy assumes each function exists on only one \r\n    //    prototype chain i.e. we use the function object for memoizing)\r\n    //    perhaps we can bookkeep on the prototype itself instead\r\n    function $super(arrayOfArgs) {\r\n      // since we are thunking a method call, performance is important here: \r\n      // memoize all lookups, once memoized the fast path calls no other \r\n      // functions\r\n      //\r\n      // find the caller (cannot be `strict` because of 'caller')\r\n      var caller = $super.caller;\r\n      // memoized 'name of method' \r\n      var nom = caller.nom;\r\n      // memoized next implementation prototype\r\n      var _super = caller._super;\r\n      if (!_super) {\r\n        if (!nom) {\r\n          nom = caller.nom = nameInThis.call(this, caller);\r\n        }\r\n        if (!nom) {\r\n          console.warn('called super() on a method not installed declaratively (has no .nom property)');\r\n        }\r\n        // super prototype is either cached or we have to find it\r\n        // by searching __proto__ (at the 'top')\r\n        // invariant: because we cache _super on fn below, we never reach \r\n        // here from inside a series of calls to super(), so it's ok to \r\n        // start searching from the prototype of 'this' (at the 'top')\r\n        // we must never memoize a null super for this reason\r\n        _super = memoizeSuper(caller, nom, getPrototypeOf(this));\r\n      }\r\n      // our super function\r\n      var fn = _super[nom];\r\n      if (fn) {\r\n        // memoize information so 'fn' can call 'super'\r\n        if (!fn._super) {\r\n          // must not memoize null, or we lose our invariant above\r\n          memoizeSuper(fn, nom, _super);\r\n        }\r\n        // invoke the inherited method\r\n        // if 'fn' is not function valued, this will throw\r\n        return fn.apply(this, arrayOfArgs || []);\r\n      }\r\n    }\r\n\r\n    function nameInThis(value) {\r\n      var p = this.__proto__;\r\n      while (p && p !== HTMLElement.prototype) {\r\n        // TODO(sjmiles): getOwnPropertyNames is absurdly expensive\r\n        var n$ = Object.getOwnPropertyNames(p);\r\n        for (var i=0, l=n$.length, n; i<l && (n=n$[i]); i++) {\r\n          var d = Object.getOwnPropertyDescriptor(p, n);\r\n          if (typeof d.value === 'function' && d.value === value) {\r\n            return n;\r\n          }\r\n        }\r\n        p = p.__proto__;\r\n      }\r\n    }\r\n\r\n    function memoizeSuper(method, name, proto) {\r\n      // find and cache next prototype containing `name`\r\n      // we need the prototype so we can do another lookup\r\n      // from here\r\n      var s = nextSuper(proto, name, method);\r\n      if (s[name]) {\r\n        // `s` is a prototype, the actual method is `s[name]`\r\n        // tag super method with it's name for quicker lookups\r\n        s[name].nom = name;\r\n      }\r\n      return method._super = s;\r\n    }\r\n\r\n    function nextSuper(proto, name, caller) {\r\n      // look for an inherited prototype that implements name\r\n      while (proto) {\r\n        if ((proto[name] !== caller) && proto[name]) {\r\n          return proto;\r\n        }\r\n        proto = getPrototypeOf(proto);\r\n      }\r\n      // must not return null, or we lose our invariant above\r\n      // in this case, a super() call was invoked where no superclass\r\n      // method exists\r\n      // TODO(sjmiles): thow an exception?\r\n      return Object;\r\n    }\r\n\r\n    // NOTE: In some platforms (IE10) the prototype chain is faked via \r\n    // __proto__. Therefore, always get prototype via __proto__ instead of\r\n    // the more standard Object.getPrototypeOf.\r\n    function getPrototypeOf(prototype) {\r\n      return prototype.__proto__;\r\n    }\r\n\r\n    // utility function to precompute name tags for functions\r\n    // in a (unchained) prototype\r\n    function hintSuper(prototype) {\r\n      // tag functions with their prototype name to optimize\r\n      // super call invocations\r\n      for (var n in prototype) {\r\n        var pd = Object.getOwnPropertyDescriptor(prototype, n);\r\n        if (pd && typeof pd.value === 'function') {\r\n          pd.value.nom = n;\r\n        }\r\n      }\r\n    }\r\n\r\n    // exports\r\n\r\n    scope.super = $super;\r\n\r\n})(Polymer);\r\n","/* \n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\n\n(function(scope) {\n\n  var typeHandlers = {\n    string: function(value) {\n      return value;\n    },\n    date: function(value) {\n      return new Date(Date.parse(value) || Date.now());\n    },\n    boolean: function(value) {\n      if (value === '') {\n        return true;\n      }\n      return value === 'false' ? false : !!value;\n    },\n    number: function(value) {\n      var n = parseFloat(value);\n      // hex values like \"0xFFFF\" parseFloat as 0\n      if (n === 0) {\n        n = parseInt(value);\n      }\n      return isNaN(n) ? value : n;\n      // this code disabled because encoded values (like \"0xFFFF\")\n      // do not round trip to their original format\n      //return (String(floatVal) === value) ? floatVal : value;\n    },\n    object: function(value, currentValue) {\n      if (currentValue === null) {\n        return value;\n      }\n      try {\n        // If the string is an object, we can parse is with the JSON library.\n        // include convenience replace for single-quotes. If the author omits\n        // quotes altogether, parse will fail.\n        return JSON.parse(value.replace(/'/g, '\"'));\n      } catch(e) {\n        // The object isn't valid JSON, return the raw value\n        return value;\n      }\n    },\n    // avoid deserialization of functions\n    'function': function(value, currentValue) {\n      return currentValue;\n    }\n  };\n\n  function deserializeValue(value, currentValue) {\n    // attempt to infer type from default value\n    var inferredType = typeof currentValue;\n    // invent 'date' type value for Date\n    if (currentValue instanceof Date) {\n      inferredType = 'date';\n    }\n    // delegate deserialization via type string\n    return typeHandlers[inferredType](value, currentValue);\n  }\n\n  // exports\n\n  scope.deserializeValue = deserializeValue;\n\n})(Polymer);\n","/*\n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\n(function(scope) {\n\n  // imports\n\n  var extend = scope.extend;\n\n  // module\n\n  var api = {};\n\n  api.declaration = {};\n  api.instance = {};\n\n  api.publish = function(apis, prototype) {\n    for (var n in apis) {\n      extend(prototype, apis[n]);\n    }\n  }\n\n  // exports\n\n  scope.api = api;\n\n})(Polymer);\n","/*\n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\n(function(scope) {\n\n  var utils = {\n    /**\n      * Invokes a function asynchronously. The context of the callback\n      * function is bound to 'this' automatically.\n      * @method async\n      * @param {Function|String} method\n      * @param {any|Array} args\n      * @param {number} timeout\n      */\n    async: function(method, args, timeout) {\n      // when polyfilling Object.observe, ensure changes \n      // propagate before executing the async method\n      Platform.flush();\n      // second argument to `apply` must be an array\n      args = (args && args.length) ? args : [args];\n      // function to invoke\n      var fn = function() {\n        (this[method] || method).apply(this, args);\n      }.bind(this);\n      // execute `fn` sooner or later\n      var handle = timeout ? setTimeout(fn, timeout) :\n          requestAnimationFrame(fn);\n      // NOTE: switch on inverting handle to determine which time is used.\n      return timeout ? handle : ~handle;\n    },\n    cancelAsync: function(handle) {\n      if (handle < 0) {\n        cancelAnimationFrame(~handle);\n      } else {\n        clearTimeout(handle);\n      }\n    },\n    /**\n      * Fire an event.\n      * @method fire\n      * @returns {Object} event\n      * @param {string} type An event name.\n      * @param {any} detail\n      * @param {Node} onNode Target node.\n      */\n    fire: function(type, detail, onNode, bubbles, cancelable) {\n      var node = onNode || this;\n      var detail = detail || {};\n      var event = new CustomEvent(type, {\n        bubbles: (bubbles !== undefined ? bubbles : true), \n        cancelable: (cancelable !== undefined ? cancelable : true), \n        detail: detail\n      });\n      node.dispatchEvent(event);\n      return event;\n    },\n    /**\n      * Fire an event asynchronously.\n      * @method asyncFire\n      * @param {string} type An event name.\n      * @param detail\n      * @param {Node} toNode Target node.\n      */\n    asyncFire: function(/*inType, inDetail*/) {\n      this.async(\"fire\", arguments);\n    },\n    /**\n      * Remove class from old, add class to anew, if they exist\n      * @param classFollows\n      * @param anew A node.\n      * @param old A node\n      * @param className\n      */\n    classFollows: function(anew, old, className) {\n      if (old) {\n        old.classList.remove(className);\n      }\n      if (anew) {\n        anew.classList.add(className);\n      }\n    }\n  };\n\n  // no-operation function for handy stubs\n  var nop = function() {};\n\n  // null-object for handy stubs\n  var nob = {};\n\n  // deprecated\n\n  utils.asyncMethod = utils.async;\n\n  // exports\n\n  scope.api.instance.utils = utils;\n  scope.nop = nop;\n  scope.nob = nob;\n\n})(Polymer);\n","/*\n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\n\n(function(scope) {\n\n  // imports\n\n  var log = window.logFlags || {};\n  var EVENT_PREFIX = 'on-';\n\n  // instance events api\n  var events = {\n    // read-only\n    EVENT_PREFIX: EVENT_PREFIX,\n    // event listeners on host\n    addHostListeners: function() {\n      var events = this.eventDelegates;\n      log.events && (Object.keys(events).length > 0) && console.log('[%s] addHostListeners:', this.localName, events);\n      // NOTE: host events look like bindings but really are not;\n      // (1) we don't want the attribute to be set and (2) we want to support\n      // multiple event listeners ('host' and 'instance') and Node.bind\n      // by default supports 1 thing being bound.\n      for (var type in events) {\n        var methodName = events[type];\n        this.addEventListener(type, this.element.getEventHandler(this, this,\n                                                                 methodName));\n      }\n    },\n    // call 'method' or function method on 'obj' with 'args', if the method exists\n    dispatchMethod: function(obj, method, args) {\n      if (obj) {\n        log.events && console.group('[%s] dispatch [%s]', obj.localName, method);\n        var fn = typeof method === 'function' ? method : obj[method];\n        if (fn) {\n          fn[args ? 'apply' : 'call'](obj, args);\n        }\n        log.events && console.groupEnd();\n        Platform.flush();\n      }\n    }\n  };\n\n  // exports\n\n  scope.api.instance.events = events;\n\n})(Polymer);\n","/*\r\n * Copyright 2013 The Polymer Authors. All rights reserved.\r\n * Use of this source code is governed by a BSD-style\r\n * license that can be found in the LICENSE file.\r\n */\r\n(function(scope) {\r\n\r\n  // instance api for attributes\r\n\r\n  var attributes = {\r\n    copyInstanceAttributes: function () {\r\n      var a$ = this._instanceAttributes;\r\n      for (var k in a$) {\r\n        if (!this.hasAttribute(k)) {\r\n          this.setAttribute(k, a$[k]);\r\n        }\r\n      }\r\n    },\r\n    // for each attribute on this, deserialize value to property as needed\r\n    takeAttributes: function() {\r\n      // if we have no publish lookup table, we have no attributes to take\r\n      // TODO(sjmiles): ad hoc\r\n      if (this._publishLC) {\r\n        for (var i=0, a$=this.attributes, l=a$.length, a; (a=a$[i]) && i<l; i++) {\r\n          this.attributeToProperty(a.name, a.value);\r\n        }\r\n      }\r\n    },\r\n    // if attribute 'name' is mapped to a property, deserialize\r\n    // 'value' into that property\r\n    attributeToProperty: function(name, value) {\r\n      // try to match this attribute to a property (attributes are\r\n      // all lower-case, so this is case-insensitive search)\r\n      var name = this.propertyForAttribute(name);\r\n      if (name) {\r\n        // filter out 'mustached' values, these are to be\r\n        // replaced with bound-data and are not yet values\r\n        // themselves\r\n        if (value && value.search(scope.bindPattern) >= 0) {\r\n          return;\r\n        }\r\n        // get original value\r\n        var currentValue = this[name];\r\n        // deserialize Boolean or Number values from attribute\r\n        var value = this.deserializeValue(value, currentValue);\r\n        // only act if the value has changed\r\n        if (value !== currentValue) {\r\n          // install new value (has side-effects)\r\n          this[name] = value;\r\n        }\r\n      }\r\n    },\r\n    // return the published property matching name, or undefined\r\n    propertyForAttribute: function(name) {\r\n      var match = this._publishLC && this._publishLC[name];\r\n      //console.log('propertyForAttribute:', name, 'matches', match);\r\n      return match;\r\n    },\r\n    // convert representation of 'stringValue' based on type of 'currentValue'\r\n    deserializeValue: function(stringValue, currentValue) {\r\n      return scope.deserializeValue(stringValue, currentValue);\r\n    },\r\n    serializeValue: function(value, inferredType) {\r\n      if (inferredType === 'boolean') {\r\n        return value ? '' : undefined;\r\n      } else if (inferredType !== 'object' && inferredType !== 'function'\r\n          && value !== undefined) {\r\n        return value;\r\n      }\r\n    },\r\n    reflectPropertyToAttribute: function(name) {\r\n      var inferredType = typeof this[name];\r\n      // try to intelligently serialize property value\r\n      var serializedValue = this.serializeValue(this[name], inferredType);\r\n      // boolean properties must reflect as boolean attributes\r\n      if (serializedValue !== undefined) {\r\n        this.setAttribute(name, serializedValue);\r\n        // TODO(sorvell): we should remove attr for all properties\r\n        // that have undefined serialization; however, we will need to\r\n        // refine the attr reflection system to achieve this; pica, for example,\r\n        // relies on having inferredType object properties not removed as\r\n        // attrs.\r\n      } else if (inferredType === 'boolean') {\r\n        this.removeAttribute(name);\r\n      }\r\n    }\r\n  };\r\n\r\n  // exports\r\n\r\n  scope.api.instance.attributes = attributes;\r\n\r\n})(Polymer);\r\n","/*\n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\n(function(scope) {\n\n  // imports\n\n  var log = window.logFlags || {};\n\n  // magic words\n\n  var OBSERVE_SUFFIX = 'Changed';\n\n  // element api\n\n  var empty = [];\n\n  var properties = {\n    createPropertyObserver: function() {\n      var n$ = this._observeNames;\n      if (n$ && n$.length) {\n        var o = this._propertyObserver = new CompoundObserver(true);\n        this.registerObservers([o]);\n        // TODO(sorvell): may not be kosher to access the value here (this[n]);\n        // previously we looked at the descriptor on the prototype\n        // this doesn't work for inheritance and not for accessors without \n        // a value property\n        for (var i=0, l=n$.length, n; (i<l) && (n=n$[i]); i++) {\n          o.addPath(this, n);\n          this.observeArrayValue(n, this[n], null);\n        }\n      }\n    },\n    openPropertyObserver: function() {\n      if (this._propertyObserver) {\n        this._propertyObserver.open(this.notifyPropertyChanges, this);\n      }\n    },\n    notifyPropertyChanges: function(newValues, oldValues, paths) {\n      var name, method, called = {};\n      for (var i in oldValues) {\n        // note: paths is of form [object, path, object, path]\n        name = paths[2 * i + 1];\n        method = this.observe[name];\n        if (method) {\n          this.observeArrayValue(name, newValues[i], oldValues[i]);\n          if (!called[method]) {\n            called[method] = true;\n            // observes the value if it is an array\n            // TODO(sorvell): call method with the set of values it's expecting;\n            // e.g. 'foo bar': 'invalidate' expects the new and old values for\n            // foo and bar. Currently we give only one of these and then\n            // deliver all the arguments.\n            this.invokeMethod(method, [oldValues[i], newValues[i], arguments]);\n          }\n        }\n      }\n    },\n    propertyChanged_: function(name, value, oldValue) {\n      if (this.reflect[name]) {\n        this.reflectPropertyToAttribute(name);\n      }\n    },\n    observeArrayValue: function(name, value, old) {\n      // we only care if there are registered side-effects\n      var callbackName = this.observe[name];\n      if (callbackName) {\n        // if we are observing the previous value, stop\n        if (Array.isArray(old)) {\n          log.observe && console.log('[%s] observeArrayValue: unregister observer [%s]', this.localName, name);\n          this.closeNamedObserver(name + '__array');\n        }\n        // if the new value is an array, being observing it\n        if (Array.isArray(value)) {\n          log.observe && console.log('[%s] observeArrayValue: register observer [%s]', this.localName, name, value);\n          var observer = new ArrayObserver(value);\n          observer.open(function(value, old) {\n            this.invokeMethod(callbackName, [old]);\n          }, this);\n          this.registerNamedObserver(name + '__array', observer);\n        }\n      }\n    },\n    bindProperty: function(property, observable, oneTime) {\n      if (oneTime) {\n        this[property] = observable;\n        return;\n      }\n      return bindProperties(this, property, observable);\n    },\n    invokeMethod: function(method, args) {\n      var fn = this[method] || method;\n      if (typeof fn === 'function') {\n        fn.apply(this, args);\n      }\n    },\n    registerObservers: function(observers) {\n      this._observers = this._observers || [];\n      this._observers.push(observers);\n    },\n    // observer array items are arrays of observers.\n    closeObservers: function() {\n      if (!this._observers) {\n        return;\n      }\n      for (var i=0, l=this._observers.length; i<l; i++) {\n        this.closeObserverArray(this._observers[i]);\n      }\n      this._observers = [];\n    },\n    closeObserverArray: function(observerArray) {\n      for (var i=0, l=observerArray.length, o; i<l; i++) {\n        o = observerArray[i];\n        if (o && o.close) {\n          o.close();\n        }\n      }\n    },\n    // bookkeeping observers for memory management\n    registerNamedObserver: function(name, observer) {\n      var o$ = this._namedObservers || (this._namedObservers = {});\n      o$[name] = observer;\n    },\n    closeNamedObserver: function(name) {\n      var o$ = this._namedObservers;\n      if (o$ && o$[name]) {\n        o$[name].close();\n        o$[name] = null;\n        return true;\n      }\n    },\n    closeNamedObservers: function() {\n      if (this._namedObservers) {\n        for (var i in this._namedObservers) {\n          this.closeNamedObserver(i);\n        }\n        this._namedObservers = {};\n      }\n    }\n  };\n\n  // property binding\n  // bind a property in A to a path in B by converting A[property] to a\n  // getter/setter pair that accesses B[...path...]\n  function bindProperties(inA, inProperty, observable) {\n    log.bind && console.log(LOG_BIND_PROPS, observable.path_, inPath, inA.localName, inProperty);\n    // apply Polymer two-way reference binding\n    return Observer.bindToInstance(inA, inProperty, observable, resolveBindingValue);\n  }\n\n  // capture A's value if B's value is null or undefined,\n  // otherwise use B's value\n  function resolveBindingValue(oldValue, value) {\n    return (value === null || value === undefined) ? oldValue : value;\n  }\n\n  // logging\n  var LOG_OBSERVE = '[%s] watching [%s]';\n  var LOG_OBSERVED = '[%s#%s] watch: [%s] now [%s] was [%s]';\n  var LOG_CHANGED = '[%s#%s] propertyChanged: [%s] now [%s] was [%s]';\n  var LOG_BIND_PROPS = \"[%s]: bindProperties: [%s] to [%s].[%s]\";\n\n  // exports\n\n  scope.api.instance.properties = properties;\n\n})(Polymer);","/*\n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\n(function(scope) {\n\n  // imports\n\n  var log = window.logFlags || 0;\n\n  // element api supporting mdv\n  var mdv = {\n    instanceTemplate: function(template) {\n      // ensure a default bindingDelegate\n      var syntax = this.syntax || (!template.bindingDelegate &&\n          this.element.syntax);\n      var dom = template.createInstance(this, syntax);\n      this.registerObservers(dom.bindings_);\n      return dom;\n    },\n    bind: function(name, observable, oneTime) {\n      var property = this.propertyForAttribute(name);\n      if (!property) {\n        // TODO(sjmiles): this mixin method must use the special form\n        // of `super` installed by `mixinMethod` in declaration/prototype.js\n        return this.mixinSuper(arguments);\n      } else {\n        // use n-way Polymer binding\n        var observer = this.bindProperty(property, observable, oneTime);\n        // NOTE: reflecting binding information is typically required only for\n        // tooling. It has a performance cost so it's opt-in in Node.bind.\n        if (Platform.enableBindingsReflection && observer) {\n          observer.path = observable.path_;\n          this._recordBinding(property, observer);\n        }\n        if (this.reflect[property]) {\n          this.reflectPropertyToAttribute(property);\n        }\n        return observer;\n      }\n    },\n    bindFinished: function() {\n      this.makeElementReady();\n    },\n    _recordBinding: function(name, observer) {\n      this.bindings_ = this.bindings_ || {};\n      this.bindings_[name] = observer;\n    },\n    // TODO(sorvell): unbind/unbindAll has been removed, as public api, from\n    // TemplateBinding. We still need to close/dispose of observers but perhaps\n    // we should choose a more explicit name.\n    asyncUnbindAll: function() {\n      if (!this._unbound) {\n        log.unbind && console.log('[%s] asyncUnbindAll', this.localName);\n        this._unbindAllJob = this.job(this._unbindAllJob, this.unbindAll, 0);\n      }\n    },\n    unbindAll: function() {\n      if (!this._unbound) {\n        this.closeObservers();\n        this.closeNamedObservers();\n        this._unbound = true;\n      }\n    },\n    cancelUnbindAll: function() {\n      if (this._unbound) {\n        log.unbind && console.warn('[%s] already unbound, cannot cancel unbindAll', this.localName);\n        return;\n      }\n      log.unbind && console.log('[%s] cancelUnbindAll', this.localName);\n      if (this._unbindAllJob) {\n        this._unbindAllJob = this._unbindAllJob.stop();\n      }\n    }\n  };\n\n  function unbindNodeTree(node) {\n    forNodeTree(node, _nodeUnbindAll);\n  }\n\n  function _nodeUnbindAll(node) {\n    node.unbindAll();\n  }\n\n  function forNodeTree(node, callback) {\n    if (node) {\n      callback(node);\n      for (var child = node.firstChild; child; child = child.nextSibling) {\n        forNodeTree(child, callback);\n      }\n    }\n  }\n\n  var mustachePattern = /\\{\\{([^{}]*)}}/;\n\n  // exports\n\n  scope.bindPattern = mustachePattern;\n  scope.api.instance.mdv = mdv;\n\n})(Polymer);\n","/*\n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\n(function(scope) {\n\n  var base = {\n    PolymerBase: true,\n    job: function(job, callback, wait) {\n      if (typeof job === 'string') {\n        var n = '___' + job;\n        this[n] = Polymer.job.call(this, this[n], callback, wait);\n      } else {\n        return Polymer.job.call(this, job, callback, wait);\n      }\n    },\n    super: Polymer.super,\n    // user entry point for element has had its createdCallback called\n    created: function() {\n    },\n    // user entry point for element has shadowRoot and is ready for\n    // api interaction\n    ready: function() {\n    },\n    createdCallback: function() {\n      if (this.templateInstance && this.templateInstance.model) {\n        console.warn('Attributes on ' + this.localName + ' were data bound ' +\n            'prior to Polymer upgrading the element. This may result in ' +\n            'incorrect binding types.');\n      }\n      this.created();\n      this.prepareElement();\n      // TODO(sorvell): replace when ShadowDOMPolyfill issue is corrected\n      // https://github.com/Polymer/ShadowDOM/issues/420\n      if (!this.ownerDocument.isStagingDocument || window.ShadowDOMPolyfill) {\n        this.makeElementReady();\n      }\n    },\n    // system entry point, do not override\n    prepareElement: function() {\n      if (this._elementPrepared) {\n        console.warn('Element already prepared', this.localName);\n        return;\n      }\n      this._elementPrepared = true;\n      // storage for shadowRoots info\n      this.shadowRoots = {};\n      // install property observers\n      this.createPropertyObserver();\n      // TODO (sorvell): temporarily open observer when created\n      this.openPropertyObserver();\n      // install boilerplate attributes\n      this.copyInstanceAttributes();\n      // process input attributes\n      this.takeAttributes();\n      // add event listeners\n      this.addHostListeners();\n    },\n    makeElementReady: function() {\n      if (this._readied) {\n        return;\n      }\n      this._readied = true;\n      // TODO(sorvell): We could create an entry point here\n      // for the user to compute property values.\n      // process declarative resources\n      this.parseDeclarations(this.__proto__);\n      // TODO(sorvell): CE polyfill uses unresolved attribute to simulate\n      // :unresolved; remove this attribute to be compatible with native\n      // CE.\n      this.removeAttribute('unresolved');\n      // user entry point\n      this.ready();\n      // TODO (sorvell): temporarily open observer when created\n      // turn on property observation and take any initial changes\n      //this.openPropertyObserver();\n    },\n    attachedCallback: function() {\n      this.cancelUnbindAll();\n      // invoke user action\n      if (this.attached) {\n        this.attached();\n      }\n      // TODO(sorvell): bc\n      if (this.enteredView) {\n        this.enteredView();\n      }\n      // NOTE: domReady can be used to access elements in dom (descendants, \n      // ancestors, siblings) such that the developer is enured to upgrade\n      // ordering. If the element definitions have loaded, domReady\n      // can be used to access upgraded elements.\n      if (!this.hasBeenAttached) {\n        this.hasBeenAttached = true;\n        if (this.domReady) {\n          this.async('domReady');\n        }\n      }\n    },\n    detachedCallback: function() {\n      if (!this.preventDispose) {\n        this.asyncUnbindAll();\n      }\n      // invoke user action\n      if (this.detached) {\n        this.detached();\n      }\n      // TODO(sorvell): bc\n      if (this.leftView) {\n        this.leftView();\n      }\n    },\n    // TODO(sorvell): bc\n    enteredViewCallback: function() {\n      this.attachedCallback();\n    },\n    // TODO(sorvell): bc\n    leftViewCallback: function() {\n      this.detachedCallback();\n    },\n    // TODO(sorvell): bc\n    enteredDocumentCallback: function() {\n      this.attachedCallback();\n    },\n    // TODO(sorvell): bc\n    leftDocumentCallback: function() {\n      this.detachedCallback();\n    },\n    // recursive ancestral <element> initialization, oldest first\n    parseDeclarations: function(p) {\n      if (p && p.element) {\n        this.parseDeclarations(p.__proto__);\n        p.parseDeclaration.call(this, p.element);\n      }\n    },\n    // parse input <element> as needed, override for custom behavior\n    parseDeclaration: function(elementElement) {\n      var template = this.fetchTemplate(elementElement);\n      if (template) {\n        var root = this.shadowFromTemplate(template);\n        this.shadowRoots[elementElement.name] = root;\n      }\n    },\n    // return a shadow-root template (if desired), override for custom behavior\n    fetchTemplate: function(elementElement) {\n      return elementElement.querySelector('template');\n    },\n    // utility function that creates a shadow root from a <template>\n    shadowFromTemplate: function(template) {\n      if (template) {\n        // make a shadow root\n        var root = this.createShadowRoot();\n        // stamp template\n        // which includes parsing and applying MDV bindings before being \n        // inserted (to avoid {{}} in attribute values)\n        // e.g. to prevent <img src=\"images/{{icon}}\"> from generating a 404.\n        var dom = this.instanceTemplate(template);\n        // append to shadow dom\n        root.appendChild(dom);\n        // perform post-construction initialization tasks on shadow root\n        this.shadowRootReady(root, template);\n        // return the created shadow root\n        return root;\n      }\n    },\n    // utility function that stamps a <template> into light-dom\n    lightFromTemplate: function(template, refNode) {\n      if (template) {\n        // TODO(sorvell): mark this element as a lightDOMController so that\n        // event listeners on bound nodes inside it will be called on it.\n        // Note, the expectation here is that events on all descendants \n        // should be handled by this element.\n        this.lightDomController = true;\n        // stamp template\n        // which includes parsing and applying MDV bindings before being \n        // inserted (to avoid {{}} in attribute values)\n        // e.g. to prevent <img src=\"images/{{icon}}\"> from generating a 404.\n        var dom = this.instanceTemplate(template);\n        // append to shadow dom\n        if (refNode) {\n          this.insertBefore(dom, refNode);          \n        } else {\n          this.appendChild(dom);\n        }\n        // perform post-construction initialization tasks on ahem, light root\n        this.shadowRootReady(this);\n        // return the created shadow root\n        return dom;\n      }\n    },\n    shadowRootReady: function(root) {\n      // locate nodes with id and store references to them in this.$ hash\n      this.marshalNodeReferences(root);\n      // set up polymer gestures\n      PolymerGestures.register(root);\n    },\n    // locate nodes with id and store references to them in this.$ hash\n    marshalNodeReferences: function(root) {\n      // establish $ instance variable\n      var $ = this.$ = this.$ || {};\n      // populate $ from nodes with ID from the LOCAL tree\n      if (root) {\n        var n$ = root.querySelectorAll(\"[id]\");\n        for (var i=0, l=n$.length, n; (i<l) && (n=n$[i]); i++) {\n          $[n.id] = n;\n        };\n      }\n    },\n    attributeChangedCallback: function(name, oldValue) {\n      // TODO(sjmiles): adhoc filter\n      if (name !== 'class' && name !== 'style') {\n        this.attributeToProperty(name, this.getAttribute(name));\n      }\n      if (this.attributeChanged) {\n        this.attributeChanged.apply(this, arguments);\n      }\n    },\n    onMutation: function(node, listener) {\n      var observer = new MutationObserver(function(mutations) {\n        listener.call(this, observer, mutations);\n        observer.disconnect();\n      }.bind(this));\n      observer.observe(node, {childList: true, subtree: true});\n    }\n  };\n\n  // true if object has own PolymerBase api\n  function isBase(object) {\n    return object.hasOwnProperty('PolymerBase') \n  }\n\n  // name a base constructor for dev tools\n\n  function PolymerBase() {};\n  PolymerBase.prototype = base;\n  base.constructor = PolymerBase;\n  \n  // exports\n\n  scope.Base = PolymerBase;\n  scope.isBase = isBase;\n  scope.api.instance.base = base;\n  \n})(Polymer);\n","/*\n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\n(function(scope) {\n\n  // imports\n\n  var log = window.logFlags || {};\n  \n  // magic words\n  \n  var STYLE_SCOPE_ATTRIBUTE = 'element';\n  var STYLE_CONTROLLER_SCOPE = 'controller';\n  \n  var styles = {\n    STYLE_SCOPE_ATTRIBUTE: STYLE_SCOPE_ATTRIBUTE,\n    /**\n     * Installs external stylesheets and <style> elements with the attribute \n     * polymer-scope='controller' into the scope of element. This is intended\n     * to be a called during custom element construction.\n    */\n    installControllerStyles: function() {\n      // apply controller styles, but only if they are not yet applied\n      var scope = this.findStyleScope();\n      if (scope && !this.scopeHasNamedStyle(scope, this.localName)) {\n        // allow inherited controller styles\n        var proto = getPrototypeOf(this), cssText = '';\n        while (proto && proto.element) {\n          cssText += proto.element.cssTextForScope(STYLE_CONTROLLER_SCOPE);\n          proto = getPrototypeOf(proto);\n        }\n        if (cssText) {\n          this.installScopeCssText(cssText, scope);\n        }\n      }\n    },\n    installScopeStyle: function(style, name, scope) {\n      var scope = scope || this.findStyleScope(), name = name || '';\n      if (scope && !this.scopeHasNamedStyle(scope, this.localName + name)) {\n        var cssText = '';\n        if (style instanceof Array) {\n          for (var i=0, l=style.length, s; (i<l) && (s=style[i]); i++) {\n            cssText += s.textContent + '\\n\\n';\n          }\n        } else {\n          cssText = style.textContent;\n        }\n        this.installScopeCssText(cssText, scope, name);\n      }\n    },\n    installScopeCssText: function(cssText, scope, name) {\n      scope = scope || this.findStyleScope();\n      name = name || '';\n      if (!scope) {\n        return;\n      }\n      if (window.ShadowDOMPolyfill) {\n        cssText = shimCssText(cssText, scope.host);\n      }\n      var style = this.element.cssTextToScopeStyle(cssText,\n          STYLE_CONTROLLER_SCOPE);\n      Polymer.applyStyleToScope(style, scope);\n      // cache that this style has been applied\n      scope._scopeStyles[this.localName + name] = true;\n    },\n    findStyleScope: function(node) {\n      // find the shadow root that contains this element\n      var n = node || this;\n      while (n.parentNode) {\n        n = n.parentNode;\n      }\n      return n;\n    },\n    scopeHasNamedStyle: function(scope, name) {\n      scope._scopeStyles = scope._scopeStyles || {};\n      return scope._scopeStyles[name];\n    }\n  };\n  \n  // NOTE: use raw prototype traversal so that we ensure correct traversal\n  // on platforms where the protoype chain is simulated via __proto__ (IE10)\n  function getPrototypeOf(prototype) {\n    return prototype.__proto__;\n  }\n\n  function shimCssText(cssText, host) {\n    var name = '', is = false;\n    if (host) {\n      name = host.localName;\n      is = host.hasAttribute('is');\n    }\n    var selector = Platform.ShadowCSS.makeScopeSelector(name, is);\n    return Platform.ShadowCSS.shimCssText(cssText, selector);\n  }\n\n  // exports\n\n  scope.api.instance.styles = styles;\n  \n})(Polymer);\n","/*\n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\n(function(scope) {\n\n  // imports\n\n  var extend = scope.extend;\n  var api = scope.api;\n\n  // imperative implementation: Polymer()\n\n  // specify an 'own' prototype for tag `name`\n  function element(name, prototype) {\n    if (arguments.length === 1 && typeof arguments[0] !== 'string') {\n      prototype = name;\n      var script = document._currentScript;\n      name = script && script.parentNode && script.parentNode.getAttribute ?\n          script.parentNode.getAttribute('name') : '';\n      if (!name) {\n        throw 'Element name could not be inferred.';\n      }\n    }\n    if (getRegisteredPrototype[name]) {\n      throw 'Already registered (Polymer) prototype for element ' + name;\n    }\n    // cache the prototype\n    registerPrototype(name, prototype);\n    // notify the registrar waiting for 'name', if any\n    notifyPrototype(name);\n  }\n\n  // async prototype source\n\n  function waitingForPrototype(name, client) {\n    waitPrototype[name] = client;\n  }\n\n  var waitPrototype = {};\n\n  function notifyPrototype(name) {\n    if (waitPrototype[name]) {\n      waitPrototype[name].registerWhenReady();\n      delete waitPrototype[name];\n    }\n  }\n\n  // utility and bookkeeping\n\n  // maps tag names to prototypes, as registered with\n  // Polymer. Prototypes associated with a tag name\n  // using document.registerElement are available from\n  // HTMLElement.getPrototypeForTag().\n  // If an element was fully registered by Polymer, then\n  // Polymer.getRegisteredPrototype(name) === \n  //   HTMLElement.getPrototypeForTag(name)\n\n  var prototypesByName = {};\n\n  function registerPrototype(name, prototype) {\n    return prototypesByName[name] = prototype || {};\n  }\n\n  function getRegisteredPrototype(name) {\n    return prototypesByName[name];\n  }\n\n  // exports\n\n  scope.getRegisteredPrototype = getRegisteredPrototype;\n  scope.waitingForPrototype = waitingForPrototype;\n\n  // namespace shenanigans so we can expose our scope on the registration \n  // function\n\n  // make window.Polymer reference `element()`\n\n  window.Polymer = element;\n\n  // TODO(sjmiles): find a way to do this that is less terrible\n  // copy window.Polymer properties onto `element()`\n\n  extend(Polymer, scope);\n\n  // Under the HTMLImports polyfill, scripts in the main document\n  // do not block on imports; we want to allow calls to Polymer in the main\n  // document. Platform collects those calls until we can process them, which\n  // we do here.\n\n  var declarations = Platform.deliverDeclarations();\n  if (declarations) {\n    for (var i=0, l=declarations.length, d; (i<l) && (d=declarations[i]); i++) {\n      element.apply(null, d);\n    }\n  }\n\n})(Polymer);\n","/* \n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\n\n(function(scope) {\n\nvar path = {\n  resolveElementPaths: function(node) {\n    Platform.urlResolver.resolveDom(node);\n  },\n  addResolvePathApi: function() {\n    // let assetpath attribute modify the resolve path\n    var assetPath = this.getAttribute('assetpath') || '';\n    var root = new URL(assetPath, this.ownerDocument.baseURI);\n    this.prototype.resolvePath = function(urlPath, base) {\n      var u = new URL(urlPath, base || root);\n      return u.href;\n    };\n  }\n};\n\n// exports\nscope.api.declaration.path = path;\n\n})(Polymer);\n","/*\n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\n(function(scope) {\n\n  // imports\n\n  var log = window.logFlags || {};\n  var api = scope.api.instance.styles;\n  var STYLE_SCOPE_ATTRIBUTE = api.STYLE_SCOPE_ATTRIBUTE;\n\n  // magic words\n\n  var STYLE_SELECTOR = 'style';\n  var STYLE_LOADABLE_MATCH = '@import';\n  var SHEET_SELECTOR = 'link[rel=stylesheet]';\n  var STYLE_GLOBAL_SCOPE = 'global';\n  var SCOPE_ATTR = 'polymer-scope';\n\n  var styles = {\n    // returns true if resources are loading\n    loadStyles: function(callback) {\n      var template = this.fetchTemplate();\n      var content = template && this.templateContent();\n      if (content) {\n        this.convertSheetsToStyles(content);\n        var styles = this.findLoadableStyles(content);\n        if (styles.length) {\n          var templateUrl = template.ownerDocument.baseURI;\n          return Platform.styleResolver.loadStyles(styles, templateUrl, callback);\n        }\n      }\n      if (callback) {\n        callback();\n      }\n    },\n    convertSheetsToStyles: function(root) {\n      var s$ = root.querySelectorAll(SHEET_SELECTOR);\n      for (var i=0, l=s$.length, s, c; (i<l) && (s=s$[i]); i++) {\n        c = createStyleElement(importRuleForSheet(s, this.ownerDocument.baseURI),\n            this.ownerDocument);\n        this.copySheetAttributes(c, s);\n        s.parentNode.replaceChild(c, s);\n      }\n    },\n    copySheetAttributes: function(style, link) {\n      for (var i=0, a$=link.attributes, l=a$.length, a; (a=a$[i]) && i<l; i++) {\n        if (a.name !== 'rel' && a.name !== 'href') {\n          style.setAttribute(a.name, a.value);\n        }\n      }\n    },\n    findLoadableStyles: function(root) {\n      var loadables = [];\n      if (root) {\n        var s$ = root.querySelectorAll(STYLE_SELECTOR);\n        for (var i=0, l=s$.length, s; (i<l) && (s=s$[i]); i++) {\n          if (s.textContent.match(STYLE_LOADABLE_MATCH)) {\n            loadables.push(s);\n          }\n        }\n      }\n      return loadables;\n    },\n    /**\n     * Install external stylesheets loaded in <polymer-element> elements into the \n     * element's template.\n     * @param elementElement The <element> element to style.\n     */\n    installSheets: function() {\n      this.cacheSheets();\n      this.cacheStyles();\n      this.installLocalSheets();\n      this.installGlobalStyles();\n    },\n    /**\n     * Remove all sheets from element and store for later use.\n     */\n    cacheSheets: function() {\n      this.sheets = this.findNodes(SHEET_SELECTOR);\n      this.sheets.forEach(function(s) {\n        if (s.parentNode) {\n          s.parentNode.removeChild(s);\n        }\n      });\n    },\n    cacheStyles: function() {\n      this.styles = this.findNodes(STYLE_SELECTOR + '[' + SCOPE_ATTR + ']');\n      this.styles.forEach(function(s) {\n        if (s.parentNode) {\n          s.parentNode.removeChild(s);\n        }\n      });\n    },\n    /**\n     * Takes external stylesheets loaded in an <element> element and moves\n     * their content into a <style> element inside the <element>'s template.\n     * The sheet is then removed from the <element>. This is done only so \n     * that if the element is loaded in the main document, the sheet does\n     * not become active.\n     * Note, ignores sheets with the attribute 'polymer-scope'.\n     * @param elementElement The <element> element to style.\n     */\n    installLocalSheets: function () {\n      var sheets = this.sheets.filter(function(s) {\n        return !s.hasAttribute(SCOPE_ATTR);\n      });\n      var content = this.templateContent();\n      if (content) {\n        var cssText = '';\n        sheets.forEach(function(sheet) {\n          cssText += cssTextFromSheet(sheet) + '\\n';\n        });\n        if (cssText) {\n          var style = createStyleElement(cssText, this.ownerDocument);\n          content.insertBefore(style, content.firstChild);\n        }\n      }\n    },\n    findNodes: function(selector, matcher) {\n      var nodes = this.querySelectorAll(selector).array();\n      var content = this.templateContent();\n      if (content) {\n        var templateNodes = content.querySelectorAll(selector).array();\n        nodes = nodes.concat(templateNodes);\n      }\n      return matcher ? nodes.filter(matcher) : nodes;\n    },\n    /**\n     * Promotes external stylesheets and <style> elements with the attribute \n     * polymer-scope='global' into global scope.\n     * This is particularly useful for defining @keyframe rules which \n     * currently do not function in scoped or shadow style elements.\n     * (See wkb.ug/72462)\n     * @param elementElement The <element> element to style.\n    */\n    // TODO(sorvell): remove when wkb.ug/72462 is addressed.\n    installGlobalStyles: function() {\n      var style = this.styleForScope(STYLE_GLOBAL_SCOPE);\n      applyStyleToScope(style, document.head);\n    },\n    cssTextForScope: function(scopeDescriptor) {\n      var cssText = '';\n      // handle stylesheets\n      var selector = '[' + SCOPE_ATTR + '=' + scopeDescriptor + ']';\n      var matcher = function(s) {\n        return matchesSelector(s, selector);\n      };\n      var sheets = this.sheets.filter(matcher);\n      sheets.forEach(function(sheet) {\n        cssText += cssTextFromSheet(sheet) + '\\n\\n';\n      });\n      // handle cached style elements\n      var styles = this.styles.filter(matcher);\n      styles.forEach(function(style) {\n        cssText += style.textContent + '\\n\\n';\n      });\n      return cssText;\n    },\n    styleForScope: function(scopeDescriptor) {\n      var cssText = this.cssTextForScope(scopeDescriptor);\n      return this.cssTextToScopeStyle(cssText, scopeDescriptor);\n    },\n    cssTextToScopeStyle: function(cssText, scopeDescriptor) {\n      if (cssText) {\n        var style = createStyleElement(cssText);\n        style.setAttribute(STYLE_SCOPE_ATTRIBUTE, this.getAttribute('name') +\n            '-' + scopeDescriptor);\n        return style;\n      }\n    }\n  };\n\n  function importRuleForSheet(sheet, baseUrl) {\n    var href = new URL(sheet.getAttribute('href'), baseUrl).href;\n    return '@import \\'' + href + '\\';';\n  }\n\n  function applyStyleToScope(style, scope) {\n    if (style) {\n      if (scope === document) {\n        scope = document.head;\n      }\n      if (window.ShadowDOMPolyfill) {\n        scope = document.head;\n      }\n      // TODO(sorvell): necessary for IE\n      // see https://connect.microsoft.com/IE/feedback/details/790212/\n      // cloning-a-style-element-and-adding-to-document-produces\n      // -unexpected-result#details\n      // var clone = style.cloneNode(true);\n      var clone = createStyleElement(style.textContent);\n      var attr = style.getAttribute(STYLE_SCOPE_ATTRIBUTE);\n      if (attr) {\n        clone.setAttribute(STYLE_SCOPE_ATTRIBUTE, attr);\n      }\n      // TODO(sorvell): probably too brittle; try to figure out \n      // where to put the element.\n      var refNode = scope.firstElementChild;\n      if (scope === document.head) {\n        var selector = 'style[' + STYLE_SCOPE_ATTRIBUTE + ']';\n        var s$ = document.head.querySelectorAll(selector);\n        if (s$.length) {\n          refNode = s$[s$.length-1].nextElementSibling;\n        }\n      }\n      scope.insertBefore(clone, refNode);\n    }\n  }\n\n  function createStyleElement(cssText, scope) {\n    scope = scope || document;\n    scope = scope.createElement ? scope : scope.ownerDocument;\n    var style = scope.createElement('style');\n    style.textContent = cssText;\n    return style;\n  }\n\n  function cssTextFromSheet(sheet) {\n    return (sheet && sheet.__resource) || '';\n  }\n\n  function matchesSelector(node, inSelector) {\n    if (matches) {\n      return matches.call(node, inSelector);\n    }\n  }\n  var p = HTMLElement.prototype;\n  var matches = p.matches || p.matchesSelector || p.webkitMatchesSelector \n      || p.mozMatchesSelector;\n  \n  // exports\n\n  scope.api.declaration.styles = styles;\n  scope.applyStyleToScope = applyStyleToScope;\n  \n})(Polymer);\n","/*\n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\n\n(function(scope) {\n\n  // imports\n\n  var log = window.logFlags || {};\n  var api = scope.api.instance.events;\n  var EVENT_PREFIX = api.EVENT_PREFIX;\n  // polymer-element declarative api: events feature\n\n  var mixedCaseEventTypes = {};\n  [\n    'webkitAnimationStart',\n    'webkitAnimationEnd',\n    'webkitTransitionEnd',\n    'DOMFocusOut',\n    'DOMFocusIn',\n    'DOMMouseScroll'\n  ].forEach(function(e) {\n    mixedCaseEventTypes[e.toLowerCase()] = e;\n  });\n\n  var events = {\n    parseHostEvents: function() {\n      // our delegates map\n      var delegates = this.prototype.eventDelegates;\n      // extract data from attributes into delegates\n      this.addAttributeDelegates(delegates);\n    },\n    addAttributeDelegates: function(delegates) {\n      // for each attribute\n      for (var i=0, a; a=this.attributes[i]; i++) {\n        // does it have magic marker identifying it as an event delegate?\n        if (this.hasEventPrefix(a.name)) {\n          // if so, add the info to delegates\n          delegates[this.removeEventPrefix(a.name)] = a.value.replace('{{', '')\n              .replace('}}', '').trim();\n        }\n      }\n    },\n    // starts with 'on-'\n    hasEventPrefix: function (n) {\n      return n && (n[0] === 'o') && (n[1] === 'n') && (n[2] === '-');\n    },\n    removeEventPrefix: function(n) {\n      return n.slice(prefixLength);\n    },\n    findController: function(node) {\n      while (node.parentNode) {\n        if (node.lightDomController) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return node.host;\n    },\n    getEventHandler: function(controller, target, method) {\n      var events = this;\n      return function(e) {\n        if (!controller || !controller.PolymerBase) {\n          controller = events.findController(target);\n        }\n\n        var args = [e, e.detail, e.currentTarget];\n        controller.dispatchMethod(controller, method, args);\n      };\n    },\n    prepareEventBinding: function(pathString, name, node) {\n      if (!this.hasEventPrefix(name))\n        return;\n\n      var eventType = this.removeEventPrefix(name);\n      eventType = mixedCaseEventTypes[eventType] || eventType;\n\n      var events = this;\n\n      return function(model, node, oneTime) {\n        var handler = events.getEventHandler(undefined, node, pathString);\n        node.addEventListener(eventType, handler);\n\n        if (oneTime)\n          return;\n\n        // TODO(rafaelw): This is really pointless work. Aside from the cost\n        // of these allocations, NodeBind is going to setAttribute back to its\n        // current value. Fixing this would mean changing the TemplateBinding\n        // binding delegate API.\n        function bindingValue() {\n          return '{{ ' + pathString + ' }}';\n        }\n\n        return {\n          open: bindingValue,\n          discardChanges: bindingValue,\n          close: function() {\n            node.removeEventListener(eventType, handler);\n          }\n        };\n      };\n    }\n  };\n\n  var prefixLength = EVENT_PREFIX.length;\n\n  // exports\n  scope.api.declaration.events = events;\n\n})(Polymer);\n","/*\r\n * Copyright 2013 The Polymer Authors. All rights reserved.\r\n * Use of this source code is governed by a BSD-style\r\n * license that can be found in the LICENSE file.\r\n */\r\n(function(scope) {\r\n\r\n  // element api\r\n\r\n  var properties = {\r\n    inferObservers: function(prototype) {\r\n      // called before prototype.observe is chained to inherited object\r\n      var observe = prototype.observe, property;\r\n      for (var n in prototype) {\r\n        if (n.slice(-7) === 'Changed') {\r\n          if (!observe) {\r\n            observe  = (prototype.observe = {});\r\n          }\r\n          property = n.slice(0, -7)\r\n          observe[property] = observe[property] || n;\r\n        }\r\n      }\r\n    },\r\n    explodeObservers: function(prototype) {\r\n      // called before prototype.observe is chained to inherited object\r\n      var o = prototype.observe;\r\n      if (o) {\r\n        var exploded = {};\r\n        for (var n in o) {\r\n          var names = n.split(' ');\r\n          for (var i=0, ni; ni=names[i]; i++) {\r\n            exploded[ni] = o[n];\r\n          }\r\n        }\r\n        prototype.observe = exploded;\r\n      }\r\n    },\r\n    optimizePropertyMaps: function(prototype) {\r\n      if (prototype.observe) {\r\n        // construct name list\r\n        var a = prototype._observeNames = [];\r\n        for (var n in prototype.observe) {\r\n          var names = n.split(' ');\r\n          for (var i=0, ni; ni=names[i]; i++) {\r\n            a.push(ni);\r\n          }\r\n        }\r\n      }\r\n      if (prototype.publish) {\r\n        // construct name list\r\n        var a = prototype._publishNames = [];\r\n        for (var n in prototype.publish) {\r\n          a.push(n);\r\n        }\r\n      }\r\n    },\r\n    publishProperties: function(prototype, base) {\r\n      // if we have any properties to publish\r\n      var publish = prototype.publish;\r\n      if (publish) {\r\n        // transcribe `publish` entries onto own prototype\r\n        this.requireProperties(publish, prototype, base);\r\n        // construct map of lower-cased property names\r\n        prototype._publishLC = this.lowerCaseMap(publish);\r\n      }\r\n    },\r\n    // sync prototype to property descriptors; \r\n    // desriptor format contains default value and optionally a \r\n    // hint for reflecting the property to an attribute.\r\n    // e.g. {foo: 5, bar: {value: true, reflect: true}}\r\n    // reflect: {foo: true} is also supported\r\n    // \r\n    requireProperties: function(propertyDescriptors, prototype, base) {\r\n      // reflected properties\r\n      prototype.reflect = prototype.reflect || {};\r\n      // ensure a prototype value for each property\r\n      // and update the property's reflect to attribute status \r\n      for (var n in propertyDescriptors) {\r\n        var propertyDescriptor = propertyDescriptors[n];\r\n        var reflects = this.reflectHintForDescriptor(propertyDescriptor);\r\n        if (prototype.reflect[n] === undefined && reflects !== undefined) {\r\n          prototype.reflect[n] = reflects;\r\n        }\r\n        if (prototype[n] === undefined) {\r\n          prototype[n] = this.valueForDescriptor(propertyDescriptor); \r\n        }\r\n      }\r\n    },\r\n    valueForDescriptor: function(propertyDescriptor) {\r\n      var value = typeof propertyDescriptor === 'object' && \r\n          propertyDescriptor ? propertyDescriptor.value : propertyDescriptor;\r\n      return value !== undefined ? value : null;\r\n    },\r\n    // returns the value of the descriptor's 'reflect' property or undefined\r\n    reflectHintForDescriptor: function(propertyDescriptor) {\r\n      if (typeof propertyDescriptor === 'object' &&\r\n          propertyDescriptor && propertyDescriptor.reflect !== undefined) {\r\n        return propertyDescriptor.reflect;\r\n      }\r\n    },\r\n    lowerCaseMap: function(properties) {\r\n      var map = {};\r\n      for (var n in properties) {\r\n        map[n.toLowerCase()] = n;\r\n      }\r\n      return map;\r\n    },\r\n    createPropertyAccessors: function(prototype) {\r\n      var n$ = prototype._publishNames;\r\n      if (n$ && n$.length) {\r\n        for (var i=0, l=n$.length, n, fn; (i<l) && (n=n$[i]); i++) {\r\n          Observer.createBindablePrototypeAccessor(prototype, n);\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  // exports\r\n\r\n  scope.api.declaration.properties = properties;\r\n\r\n})(Polymer);\r\n","/*\n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\n(function(scope) {\n\n  // magic words\n\n  var ATTRIBUTES_ATTRIBUTE = 'attributes';\n  var ATTRIBUTES_REGEX = /\\s|,/;\n\n  // attributes api\n\n  var attributes = {\n    inheritAttributesObjects: function(prototype) {\n      // chain our lower-cased publish map to the inherited version\n      this.inheritObject(prototype, 'publishLC');\n      // chain our instance attributes map to the inherited version\n      this.inheritObject(prototype, '_instanceAttributes');\n    },\n    publishAttributes: function(prototype, base) {\n      // merge names from 'attributes' attribute\n      var attributes = this.getAttribute(ATTRIBUTES_ATTRIBUTE);\n      if (attributes) {\n        // get properties to publish\n        var publish = prototype.publish || (prototype.publish = {});\n        // names='a b c' or names='a,b,c'\n        var names = attributes.split(ATTRIBUTES_REGEX);\n        // record each name for publishing\n        for (var i=0, l=names.length, n; i<l; i++) {\n          // remove excess ws\n          n = names[i].trim();\n          // do not override explicit entries\n          if (n && publish[n] === undefined && base[n] === undefined) {\n            publish[n] = null;\n          }\n        }\n      }\n    },\n    // record clonable attributes from <element>\n    accumulateInstanceAttributes: function() {\n      // inherit instance attributes\n      var clonable = this.prototype._instanceAttributes;\n      // merge attributes from element\n      var a$ = this.attributes;\n      for (var i=0, l=a$.length, a; (i<l) && (a=a$[i]); i++) {  \n        if (this.isInstanceAttribute(a.name)) {\n          clonable[a.name] = a.value;\n        }\n      }\n    },\n    isInstanceAttribute: function(name) {\n      return !this.blackList[name] && name.slice(0,3) !== 'on-';\n    },\n    // do not clone these attributes onto instances\n    blackList: {\n      name: 1,\n      'extends': 1,\n      constructor: 1,\n      noscript: 1,\n      assetpath: 1,\n      'cache-csstext': 1\n    }\n  };\n\n  // add ATTRIBUTES_ATTRIBUTE to the blacklist\n  attributes.blackList[ATTRIBUTES_ATTRIBUTE] = 1;\n\n  // exports\n\n  scope.api.declaration.attributes = attributes;\n\n})(Polymer);\n","/*\n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\n(function(scope) {\n\n  // imports\n  var events = scope.api.declaration.events;\n\n  var syntax = new PolymerExpressions();\n  var prepareBinding = syntax.prepareBinding;\n\n  // Polymer takes a first crack at the binding to see if it's a declarative\n  // event handler.\n  syntax.prepareBinding = function(pathString, name, node) {\n    return events.prepareEventBinding(pathString, name, node) ||\n           prepareBinding.call(syntax, pathString, name, node);\n  };\n\n  // declaration api supporting mdv\n  var mdv = {\n    syntax: syntax,\n    fetchTemplate: function() {\n      return this.querySelector('template');\n    },\n    templateContent: function() {\n      var template = this.fetchTemplate();\n      return template && Platform.templateContent(template);\n    },\n    installBindingDelegate: function(template) {\n      if (template) {\n        template.bindingDelegate = this.syntax;\n      }\n    }\n  };\n\n  // exports\n  scope.api.declaration.mdv = mdv;\n\n})(Polymer);\n","/*\n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\n(function(scope) {\n\n  // imports\n  \n  var api = scope.api;\n  var isBase = scope.isBase;\n  var extend = scope.extend;\n\n  // prototype api\n\n  var prototype = {\n\n    register: function(name, extendeeName) {\n      // build prototype combining extendee, Polymer base, and named api\n      this.buildPrototype(name, extendeeName);\n      // register our custom element with the platform\n      this.registerPrototype(name, extendeeName);\n      // reference constructor in a global named by 'constructor' attribute\n      this.publishConstructor();\n    },\n\n    buildPrototype: function(name, extendeeName) {\n      // get our custom prototype (before chaining)\n      var extension = scope.getRegisteredPrototype(name);\n      // get basal prototype\n      var base = this.generateBasePrototype(extendeeName);\n      // implement declarative features\n      this.desugarBeforeChaining(extension, base);\n      // join prototypes\n      this.prototype = this.chainPrototypes(extension, base);\n      // more declarative features\n      this.desugarAfterChaining(name, extendeeName);\n    },\n\n    desugarBeforeChaining: function(prototype, base) {\n      // back reference declaration element\n      // TODO(sjmiles): replace `element` with `elementElement` or `declaration`\n      prototype.element = this;\n      // transcribe `attributes` declarations onto own prototype's `publish`\n      this.publishAttributes(prototype, base);\n      // `publish` properties to the prototype and to attribute watch\n      this.publishProperties(prototype, base);\n      // infer observers for `observe` list based on method names\n      this.inferObservers(prototype);\n      // desugar compound observer syntax, e.g. 'a b c' \n      this.explodeObservers(prototype);\n    },\n\n    chainPrototypes: function(prototype, base) {\n      // chain various meta-data objects to inherited versions\n      this.inheritMetaData(prototype, base);\n      // chain custom api to inherited\n      var chained = this.chainObject(prototype, base);\n      // x-platform fixup\n      ensurePrototypeTraversal(chained);\n      return chained;\n    },\n\n    inheritMetaData: function(prototype, base) {\n      // chain observe object to inherited\n      this.inheritObject('observe', prototype, base);\n      // chain publish object to inherited\n      this.inheritObject('publish', prototype, base);\n      // chain reflect object to inherited\n      this.inheritObject('reflect', prototype, base);\n      // chain our lower-cased publish map to the inherited version\n      this.inheritObject('_publishLC', prototype, base);\n      // chain our instance attributes map to the inherited version\n      this.inheritObject('_instanceAttributes', prototype, base);\n      // chain our event delegates map to the inherited version\n      this.inheritObject('eventDelegates', prototype, base);\n    },\n\n    // implement various declarative features\n    desugarAfterChaining: function(name, extendee) {\n      // build side-chained lists to optimize iterations\n      this.optimizePropertyMaps(this.prototype);\n      this.createPropertyAccessors(this.prototype);\n      // install mdv delegate on template\n      this.installBindingDelegate(this.fetchTemplate());\n      // install external stylesheets as if they are inline\n      this.installSheets();\n      // adjust any paths in dom from imports\n      this.resolveElementPaths(this);\n      // compile list of attributes to copy to instances\n      this.accumulateInstanceAttributes();\n      // parse on-* delegates declared on `this` element\n      this.parseHostEvents();\n      //\n      // install a helper method this.resolvePath to aid in \n      // setting resource urls. e.g.\n      // this.$.image.src = this.resolvePath('images/foo.png')\n      this.addResolvePathApi();\n      // under ShadowDOMPolyfill, transforms to approximate missing CSS features\n      if (window.ShadowDOMPolyfill) {\n        Platform.ShadowCSS.shimStyling(this.templateContent(), name, extendee);\n      }\n      // allow custom element access to the declarative context\n      if (this.prototype.registerCallback) {\n        this.prototype.registerCallback(this);\n      }\n    },\n\n    // if a named constructor is requested in element, map a reference\n    // to the constructor to the given symbol\n    publishConstructor: function() {\n      var symbol = this.getAttribute('constructor');\n      if (symbol) {\n        window[symbol] = this.ctor;\n      }\n    },\n\n    // build prototype combining extendee, Polymer base, and named api\n    generateBasePrototype: function(extnds) {\n      var prototype = this.findBasePrototype(extnds);\n      if (!prototype) {\n        // create a prototype based on tag-name extension\n        var prototype = HTMLElement.getPrototypeForTag(extnds);\n        // insert base api in inheritance chain (if needed)\n        prototype = this.ensureBaseApi(prototype);\n        // memoize this base\n        memoizedBases[extnds] = prototype;\n      }\n      return prototype;\n    },\n\n    findBasePrototype: function(name) {\n      return memoizedBases[name];\n    },\n\n    // install Polymer instance api into prototype chain, as needed \n    ensureBaseApi: function(prototype) {\n      if (prototype.PolymerBase) {\n        return prototype;\n      }\n      var extended = Object.create(prototype);\n      // we need a unique copy of base api for each base prototype\n      // therefore we 'extend' here instead of simply chaining\n      api.publish(api.instance, extended);\n      // TODO(sjmiles): sharing methods across prototype chains is\n      // not supported by 'super' implementation which optimizes\n      // by memoizing prototype relationships.\n      // Probably we should have a version of 'extend' that is \n      // share-aware: it could study the text of each function,\n      // look for usage of 'super', and wrap those functions in\n      // closures.\n      // As of now, there is only one problematic method, so \n      // we just patch it manually.\n      // To avoid re-entrancy problems, the special super method\n      // installed is called `mixinSuper` and the mixin method\n      // must use this method instead of the default `super`.\n      this.mixinMethod(extended, prototype, api.instance.mdv, 'bind');\n      // return buffed-up prototype\n      return extended;\n    },\n\n    mixinMethod: function(extended, prototype, api, name) {\n      var $super = function(args) {\n        return prototype[name].apply(this, args);\n      };\n      extended[name] = function() {\n        this.mixinSuper = $super;\n        return api[name].apply(this, arguments);\n      }\n    },\n\n    // ensure prototype[name] inherits from a prototype.prototype[name]\n    inheritObject: function(name, prototype, base) {\n      // require an object\n      var source = prototype[name] || {};\n      // chain inherited properties onto a new object\n      prototype[name] = this.chainObject(source, base[name]);\n    },\n\n    // register 'prototype' to custom element 'name', store constructor \n    registerPrototype: function(name, extendee) { \n      var info = {\n        prototype: this.prototype\n      }\n      // native element must be specified in extends\n      var typeExtension = this.findTypeExtension(extendee);\n      if (typeExtension) {\n        info.extends = typeExtension;\n      }\n      // register the prototype with HTMLElement for name lookup\n      HTMLElement.register(name, this.prototype);\n      // register the custom type\n      this.ctor = document.registerElement(name, info);\n    },\n\n    findTypeExtension: function(name) {\n      if (name && name.indexOf('-') < 0) {\n        return name;\n      } else {\n        var p = this.findBasePrototype(name);\n        if (p.element) {\n          return this.findTypeExtension(p.element.extends);\n        }\n      }\n    }\n\n  };\n\n  // memoize base prototypes\n  var memoizedBases = {};\n\n  // implementation of 'chainObject' depends on support for __proto__\n  if (Object.__proto__) {\n    prototype.chainObject = function(object, inherited) {\n      if (object && inherited && object !== inherited) {\n        object.__proto__ = inherited;\n      }\n      return object;\n    }\n  } else {\n    prototype.chainObject = function(object, inherited) {\n      if (object && inherited && object !== inherited) {\n        var chained = Object.create(inherited);\n        object = extend(chained, object);\n      }\n      return object;\n    }\n  }\n\n  // On platforms that do not support __proto__ (versions of IE), the prototype\n  // chain of a custom element is simulated via installation of __proto__.\n  // Although custom elements manages this, we install it here so it's\n  // available during desugaring.\n  function ensurePrototypeTraversal(prototype) {\n    if (!Object.__proto__) {\n      var ancestor = Object.getPrototypeOf(prototype);\n      prototype.__proto__ = ancestor;\n      if (isBase(ancestor)) {\n        ancestor.__proto__ = Object.getPrototypeOf(ancestor);\n      }\n    }\n  }\n\n  // exports\n\n  api.declaration.prototype = prototype;\n\n})(Polymer);\n","/*\n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\n(function(scope) {\n\n  var queue = {\n    // tell the queue to wait for an element to be ready\n    wait: function(element, check, go) {\n      if (this.indexOf(element) === -1) {\n        this.add(element);\n        element.__check = check;\n        element.__go = go;\n      }\n      return (this.indexOf(element) !== 0);\n    },\n    add: function(element) {\n      //console.log('queueing', element.name);\n      queueForElement(element).push(element);\n    },\n    indexOf: function(element) {\n      var i = queueForElement(element).indexOf(element);\n      if (i >= 0 && document.contains(element)) {\n        i += (HTMLImports.useNative || HTMLImports.ready) ? \n          importQueue.length : 1e9;\n      }\n      return i;  \n    },\n    // tell the queue an element is ready to be registered\n    go: function(element) {\n      var readied = this.remove(element);\n      if (readied) {\n        readied.__go.call(readied);\n        readied.__check = readied.__go = null;\n        this.check();\n      }\n    },\n    remove: function(element) {\n      var i = this.indexOf(element);\n      if (i !== 0) {\n        //console.warn('queue order wrong', i);\n        return;\n      }\n      return queueForElement(element).shift();\n    },\n    check: function() {\n      // next\n      var element = this.nextElement();\n      if (element) {\n        element.__check.call(element);\n      }\n      if (this.canReady()) {\n        this.ready();\n        return true;\n      }\n    },\n    nextElement: function() {\n      return nextQueued();\n    },\n    canReady: function() {\n      return !this.waitToReady && this.isEmpty();\n    },\n    isEmpty: function() {\n      return !importQueue.length && !mainQueue.length;\n    },\n    ready: function() {\n      // TODO(sorvell): As an optimization, turn off CE polyfill upgrading\n      // while registering. This way we avoid having to upgrade each document\n      // piecemeal per registration and can instead register all elements\n      // and upgrade once in a batch. Without this optimization, upgrade time\n      // degrades significantly when SD polyfill is used. This is mainly because\n      // querying the document tree for elements is slow under the SD polyfill.\n      if (CustomElements.ready === false) {\n        CustomElements.upgradeDocumentTree(document);\n        CustomElements.ready = true;\n      }\n      if (readyCallbacks) {\n        var fn;\n        while (readyCallbacks.length) {\n          fn = readyCallbacks.shift();\n          fn();\n        }\n      }\n    },\n    addReadyCallback: function(callback) {\n      if (callback) {\n        readyCallbacks.push(callback);\n      }\n    },\n    waitToReady: true\n  };\n\n  var importQueue = [];\n  var mainQueue = [];\n  var readyCallbacks = [];\n\n  function queueForElement(element) {\n    return document.contains(element) ? mainQueue : importQueue;\n  }\n\n  function nextQueued() {\n    return importQueue.length ? importQueue[0] : mainQueue[0];\n  }\n\n  var polymerReadied = false; \n\n  document.addEventListener('WebComponentsReady', function() {\n    CustomElements.ready = false;\n  });\n  \n  function whenPolymerReady(callback) {\n    queue.waitToReady = true;\n    CustomElements.ready = false;\n    HTMLImports.whenImportsReady(function() {\n      queue.addReadyCallback(callback);\n      queue.waitToReady = false;\n      queue.check();\n    });\n  }\n\n  // exports\n  scope.queue = queue;\n  scope.whenPolymerReady = whenPolymerReady;\n})(Polymer);\n","/*\n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\n(function(scope) {\n\n  var whenPolymerReady = scope.whenPolymerReady;\n\n  function importElements(elementOrFragment, callback) {\n    if (elementOrFragment) {\n      document.head.appendChild(elementOrFragment);\n      whenPolymerReady(callback);\n    } else if (callback) {\n      callback();\n    }\n  }\n\n  function importUrls(urls, callback) {\n    if (urls && urls.length) {\n        var frag = document.createDocumentFragment();\n        for (var i=0, l=urls.length, url, link; (i<l) && (url=urls[i]); i++) {\n          link = document.createElement('link');\n          link.rel = 'import';\n          link.href = url;\n          frag.appendChild(link);\n        }\n        importElements(frag, callback);\n    } else if (callback) {\n      callback();\n    }\n  }\n\n  // exports\n  scope.import = importUrls;\n  scope.importElements = importElements;\n\n})(Polymer);\n","/*\n * Copyright 2013 The Polymer Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file.\n */\n(function(scope) {\n\n  // imports\n\n  var extend = scope.extend;\n  var api = scope.api;\n  var queue = scope.queue;\n  var whenPolymerReady = scope.whenPolymerReady;\n  var getRegisteredPrototype = scope.getRegisteredPrototype;\n  var waitingForPrototype = scope.waitingForPrototype;\n\n  // declarative implementation: <polymer-element>\n\n  var prototype = extend(Object.create(HTMLElement.prototype), {\n\n    createdCallback: function() {\n      if (this.getAttribute('name')) {\n        this.init();\n      }\n    },\n\n    init: function() {\n      // fetch declared values\n      this.name = this.getAttribute('name');\n      this.extends = this.getAttribute('extends');\n      // initiate any async resource fetches\n      this.loadResources();\n      // register when all constraints are met\n      this.registerWhenReady();\n    },\n\n    registerWhenReady: function() {\n     if (this.registered\n       || this.waitingForPrototype(this.name)\n       || this.waitingForQueue()\n       || this.waitingForResources()) {\n          return;\n      }\n      // TODO(sorvell): ends up calling '_register' by virtue\n      // of `waitingForQueue` (see below)\n      queue.go(this);\n    },\n\n    // TODO(sorvell): refactor, this method is private-ish, but it's being\n    // called by the queue object.\n    _register: function() {\n      //console.log('registering', this.name);\n      //console.group('registering', this.name);\n      // warn if extending from a custom element not registered via Polymer\n      if (isCustomTag(this.extends) && !isRegistered(this.extends)) {\n        console.warn('%s is attempting to extend %s, an unregistered element ' +\n            'or one that was not registered with Polymer.', this.name,\n            this.extends);\n      }\n      this.register(this.name, this.extends);\n      this.registered = true;\n      //console.groupEnd();\n    },\n\n    waitingForPrototype: function(name) {\n      if (!getRegisteredPrototype(name)) {\n        // then wait for a prototype\n        waitingForPrototype(name, this);\n        // emulate script if user is not supplying one\n        this.handleNoScript(name);\n        // prototype not ready yet\n        return true;\n      }\n    },\n\n    handleNoScript: function(name) {\n      // if explicitly marked as 'noscript'\n      if (this.hasAttribute('noscript') && !this.noscript) {\n        this.noscript = true;\n        // TODO(sorvell): CustomElements polyfill awareness:\n        // noscript elements should upgrade in logical order\n        // script injection ensures this under native custom elements;\n        // under imports + ce polyfills, scripts run before upgrades.\n        // dependencies should be ready at upgrade time so register\n        // prototype at this time.\n        if (window.CustomElements && !CustomElements.useNative) {\n          Polymer(name);\n        } else {\n          var script = document.createElement('script');\n          script.textContent = 'Polymer(\\'' + name + '\\');';\n          this.appendChild(script);\n        }\n      }\n    },\n\n    waitingForResources: function() {\n      return this._needsResources;\n    },\n\n    // NOTE: Elements must be queued in proper order for inheritance/composition\n    // dependency resolution. Previously this was enforced for inheritance,\n    // and by rule for composition. It's now entirely by rule.\n    waitingForQueue: function() {\n      return queue.wait(this, this.registerWhenReady, this._register);\n    },\n\n    loadResources: function() {\n      this._needsResources = true;\n      this.loadStyles(function() {\n        this._needsResources = false;\n        this.registerWhenReady();\n      }.bind(this));\n    }\n\n  });\n\n  // semi-pluggable APIs \n\n  // TODO(sjmiles): should be fully pluggable (aka decoupled, currently\n  // the various plugins are allowed to depend on each other directly)\n  api.publish(api.declaration, prototype);\n\n  // utility and bookkeeping\n\n  function isRegistered(name) {\n    return Boolean(HTMLElement.getPrototypeForTag(name));\n  }\n\n  function isCustomTag(name) {\n    return (name && name.indexOf('-') >= 0);\n  }\n\n  // boot tasks\n\n  whenPolymerReady(function() {\n    document.body.removeAttribute('unresolved');\n    document.dispatchEvent(\n      new CustomEvent('polymer-ready', {bubbles: true})\n    );\n  });\n\n  // register polymer-element with document\n\n  document.registerElement('polymer-element', {prototype: prototype});\n\n})(Polymer);\n"]}